<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>TIFN2: Red fluorescent plaque development in gingivitis • CMTFtoolbox</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="TIFN2: Red fluorescent plaque development in gingivitis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CMTFtoolbox</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/AP.html">AP: pain perception in apical periodontitis</a></li>
    <li><a class="dropdown-item" href="../articles/GOHTRANS.html">GOHTRANS: gender-affirming hormone therapy</a></li>
    <li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/MAINHEALTH.html">MAINHEALTH: intergenerational obesity transmission</a></li>
    <li><a class="dropdown-item" href="../articles/TIFN2.html">TIFN2: Red fluorescent plaque development in gingivitis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/GRvanderPloeg/CMTFtoolbox/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>TIFN2: Red fluorescent plaque development in gingivitis</h1>
            
            <h4 data-toc-skip class="date">2025-08-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/GRvanderPloeg/CMTFtoolbox/blob/master/vignettes/articles/TIFN2.Rmd" class="external-link"><code>vignettes/articles/TIFN2.Rmd</code></a></small>
      <div class="d-none name"><code>TIFN2.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="preamble">Preamble<a class="anchor" aria-label="anchor" href="#preamble"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://grvanderploeg.com/parafac4microbiome/" class="external-link">parafac4microbiome</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/GRvanderPloeg/NPLStoolbox" class="external-link">NPLStoolbox</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://grvanderploeg.com/CMTFtoolbox/">CMTFtoolbox</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'CMTFtoolbox'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:NPLStoolbox':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     npred</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:parafac4microbiome':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     fac_to_vect, reinflateFac, reinflateTensor, vect_to_fac</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/trevorld/ggpattern" class="external-link">ggpattern</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rf_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"./TIFN2/RFdata.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">rf_data</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"subject"</span>, <span class="st">"id"</span>, <span class="st">"fotonr"</span>, <span class="st">"day"</span>, <span class="st">"group"</span>, <span class="st">"RFgroup"</span>, <span class="st">"MQH"</span>, <span class="st">"SPS(tm)"</span>, <span class="st">"Area_delta_R30"</span>, <span class="st">"Area_delta_Rmax"</span>, <span class="st">"Area_delta_R30_x_Rmax"</span>, <span class="st">"gingiva_mean_R_over_G"</span>, <span class="st">"gingiva_mean_R_over_G_upper_jaw"</span>, <span class="st">"gingiva_mean_R_over_G_lower_jaw"</span><span class="op">)</span></span>
<span><span class="va">rf_data</span> <span class="op">=</span> <span class="va">rf_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rf_data</span><span class="op">[</span><span class="va">rf_data</span><span class="op">$</span><span class="va">subject</span> <span class="op">==</span> <span class="st">"VSTPHZ"</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"VSTPH2"</span></span>
<span><span class="va">rf_data</span><span class="op">[</span><span class="va">rf_data</span><span class="op">$</span><span class="va">subject</span> <span class="op">==</span> <span class="st">"D2VZH0"</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"DZVZH0"</span></span>
<span><span class="va">rf_data</span><span class="op">[</span><span class="va">rf_data</span><span class="op">$</span><span class="va">subject</span> <span class="op">==</span> <span class="st">"DLODNN"</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"DLODDN"</span></span>
<span><span class="va">rf_data</span><span class="op">[</span><span class="va">rf_data</span><span class="op">$</span><span class="va">subject</span> <span class="op">==</span> <span class="st">"O3VQFX"</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"O3VQFQ"</span></span>
<span><span class="va">rf_data</span><span class="op">[</span><span class="va">rf_data</span><span class="op">$</span><span class="va">subject</span> <span class="op">==</span> <span class="st">"F80LGT"</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"F80LGF"</span></span>
<span><span class="va">rf_data</span><span class="op">[</span><span class="va">rf_data</span><span class="op">$</span><span class="va">subject</span> <span class="op">==</span> <span class="st">"26QQR0"</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"26QQrO"</span></span>
<span></span>
<span><span class="va">rf_data2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"./TIFN2/red_fluorescence_data.csv"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rf_data2</span> <span class="op">=</span> <span class="va">rf_data2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">181</span><span class="op">:</span><span class="fl">192</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">rf_data</span> <span class="op">=</span> <span class="va">rf_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">rf_data2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(id, day)`</span></span>
<span></span>
<span><span class="va">rf</span> <span class="op">=</span> <span class="va">rf_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">subject</span>, <span class="va">RFgroup</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age_gender</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"./TIFN2/Ploeg_subjectMetadata.csv"</span>, sep<span class="op">=</span><span class="st">";"</span><span class="op">)</span></span>
<span><span class="va">age_gender</span> <span class="op">=</span> <span class="va">age_gender</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">age_gender</span><span class="op">)</span>,<span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">age_gender</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">age_gender</span> <span class="op">=</span> <span class="va">age_gender</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">onderzoeksgroep</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">naam</span>, <span class="va">leeftijd</span>, <span class="va">geslacht</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">age_gender</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"subject"</span>, <span class="st">"age"</span>, <span class="st">"gender"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Correction for incorrect subject ids</span></span>
<span><span class="va">age_gender</span><span class="op">[</span><span class="va">age_gender</span><span class="op">$</span><span class="va">subject</span> <span class="op">==</span> <span class="st">"VSTPHZ"</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"VSTPH2"</span></span>
<span><span class="va">age_gender</span><span class="op">[</span><span class="va">age_gender</span><span class="op">$</span><span class="va">subject</span> <span class="op">==</span> <span class="st">"D2VZH0"</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"DZVZH0"</span></span>
<span><span class="va">age_gender</span><span class="op">[</span><span class="va">age_gender</span><span class="op">$</span><span class="va">subject</span> <span class="op">==</span> <span class="st">"DLODNN"</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"DLODDN"</span></span>
<span><span class="va">age_gender</span><span class="op">[</span><span class="va">age_gender</span><span class="op">$</span><span class="va">subject</span> <span class="op">==</span> <span class="st">"O3VQFX"</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"O3VQFQ"</span></span>
<span><span class="va">age_gender</span><span class="op">[</span><span class="va">age_gender</span><span class="op">$</span><span class="va">subject</span> <span class="op">==</span> <span class="st">"F80LGT"</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"F80LGF"</span></span>
<span><span class="va">age_gender</span><span class="op">[</span><span class="va">age_gender</span><span class="op">$</span><span class="va">subject</span> <span class="op">==</span> <span class="st">"26QQR0"</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"26QQrO"</span></span>
<span></span>
<span><span class="va">age_gender</span> <span class="op">=</span> <span class="va">age_gender</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">subject</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">mapping</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span></span>
<span></span>
<span><span class="va">testMetadata</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span>, <span class="va">comp</span>, <span class="va">metadata</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">transformedSubjectLoadings</span> <span class="op">=</span> <span class="fu"><a href="https://grvanderploeg.github.io/parafac4microbiome/reference/transformPARAFACloadings.html" class="external-link">transformPARAFACloadings</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">Fac</span>, <span class="fl">1</span><span class="op">)</span><span class="op">[</span>,<span class="va">comp</span><span class="op">]</span></span>
<span>  <span class="va">transformedSubjectLoadings</span> <span class="op">=</span> <span class="va">transformedSubjectLoadings</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/norm.html" class="external-link">norm</a></span><span class="op">(</span><span class="va">transformedSubjectLoadings</span>, <span class="st">"2"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">metadata</span> <span class="op">=</span> <span class="va">metadata</span><span class="op">$</span><span class="va">mode1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">vanderPloeg2024</span><span class="op">$</span><span class="va">red_fluorescence</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">subject</span>,<span class="va">day</span>,<span class="va">Area_delta_R30</span>,<span class="va">plaquepercent</span>,<span class="va">bomppercent</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">day</span><span class="op">==</span><span class="fl">14</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"subject"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">transformedSubjectLoadings</span> <span class="op">~</span> <span class="va">plaquepercent</span> <span class="op">+</span> <span class="va">bomppercent</span> <span class="op">+</span> <span class="va">Area_delta_R30</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">age</span>, data<span class="op">=</span><span class="va">metadata</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Extract coefficients and confidence intervals</span></span>
<span>  <span class="va">coef_estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span>
<span>  <span class="va">conf_intervals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Remove intercept</span></span>
<span>  <span class="va">coef_estimates</span> <span class="op">&lt;-</span> <span class="va">coef_estimates</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">coef_estimates</span><span class="op">)</span> <span class="op">!=</span> <span class="st">"(Intercept)"</span>, <span class="op">]</span></span>
<span>  <span class="va">conf_intervals</span> <span class="op">&lt;-</span> <span class="va">conf_intervals</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">conf_intervals</span><span class="op">)</span> <span class="op">!=</span> <span class="st">"(Intercept)"</span>, <span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Combine into a clean data frame</span></span>
<span>  <span class="va">summary_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Term     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">coef_estimates</span><span class="op">)</span>,</span>
<span>    Estimate <span class="op">=</span> <span class="va">coef_estimates</span><span class="op">[</span>, <span class="st">"Estimate"</span><span class="op">]</span> <span class="op">*</span> <span class="fl">1e3</span>,</span>
<span>    CI       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>                 <span class="va">conf_intervals</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="st">" – "</span>,</span>
<span>                 <span class="va">conf_intervals</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span>               <span class="op">)</span>,</span>
<span>    P_value  <span class="op">=</span> <span class="va">coef_estimates</span><span class="op">[</span>, <span class="st">"Pr(&gt;|t|)"</span><span class="op">]</span>,</span>
<span>    P_adjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">coef_estimates</span><span class="op">[</span>, <span class="st">"Pr(&gt;|t|)"</span><span class="op">]</span>, <span class="st">"BH"</span><span class="op">)</span>,</span>
<span>    row.names <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">summary_table</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">testFeatures</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span>, <span class="va">metadata</span>, <span class="va">componentNum</span>, <span class="va">metadataVar</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">=</span> <span class="va">metadata</span><span class="op">$</span><span class="va">mode1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">rf_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">day</span><span class="op">==</span><span class="fl">14</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">age_gender</span><span class="op">)</span></span>
<span>  <span class="va">topIndices</span> <span class="op">=</span> <span class="va">metadata</span><span class="op">$</span><span class="va">mode2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>index<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, Comp <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">componentNum</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">Comp</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">bottomIndices</span> <span class="op">=</span> <span class="va">metadata</span><span class="op">$</span><span class="va">mode2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>index<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, Comp <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">componentNum</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">Comp</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">timepoint</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">componentNum</span><span class="op">]</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">componentNum</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Xhat</span> <span class="op">=</span> <span class="fu">parafac4microbiome</span><span class="fu">::</span><span class="fu"><a href="https://grvanderploeg.github.io/parafac4microbiome/reference/reinflateTensor.html" class="external-link">reinflateTensor</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">componentNum</span><span class="op">]</span>, <span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">componentNum</span><span class="op">]</span>, <span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">componentNum</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">=</span> <span class="va">df</span><span class="op">[</span><span class="va">metadataVar</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Positive loadings:"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">Xhat</span><span class="op">[</span>,<span class="va">topIndices</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">timepoint</span><span class="op">]</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Negative loadings:"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">Xhat</span><span class="op">[</span>,<span class="va">bottomIndices</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">timepoint</span><span class="op">]</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">plotFeatures</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">mode2</span>, <span class="va">model</span>, <span class="va">componentNum</span>, <span class="va">flip</span><span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">flip</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">df</span> <span class="op">=</span> <span class="va">mode2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Comp <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">componentNum</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Comp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>index<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">Genus</span>, <span class="va">Species</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">df</span> <span class="op">=</span> <span class="va">mode2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Comp <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">componentNum</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Comp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>index<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">Genus</span>, <span class="va">Species</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span><span class="op">)</span>, <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">plot</span><span class="op">=</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Comp</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Phylum</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">df</span><span class="op">$</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Phylum"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phylum_colors</span> <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/pal_hue.html" class="external-link">hue_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="acmtf">ACMTF<a class="anchor" aria-label="anchor" href="#acmtf"></a>
</h2>
<div class="section level3">
<h3 id="process">Process<a class="anchor" aria-label="anchor" href="#process"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">homogenizedSubjects</span> <span class="op">=</span> <span class="fu">parafac4microbiome</span><span class="fu">::</span><span class="va"><a href="https://grvanderploeg.github.io/parafac4microbiome/reference/vanderPloeg2024.html" class="external-link">vanderPloeg2024</a></span><span class="op">$</span><span class="va">metabolomics</span><span class="op">$</span><span class="va">mode1</span><span class="op">$</span><span class="va">subject</span></span>
<span><span class="va">mask</span> <span class="op">=</span> <span class="fu">parafac4microbiome</span><span class="fu">::</span><span class="va"><a href="https://grvanderploeg.github.io/parafac4microbiome/reference/vanderPloeg2024.html" class="external-link">vanderPloeg2024</a></span><span class="op">$</span><span class="va">tongue</span><span class="op">$</span><span class="va">mode1</span><span class="op">$</span><span class="va">subject</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">homogenizedSubjects</span></span>
<span></span>
<span><span class="co"># Tongue</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu">parafac4microbiome</span><span class="fu">::</span><span class="va"><a href="https://grvanderploeg.github.io/parafac4microbiome/reference/vanderPloeg2024.html" class="external-link">vanderPloeg2024</a></span><span class="op">$</span><span class="va">tongue</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">data</span> <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">mask</span>,,<span class="op">]</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">mode1</span> <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">mode1</span><span class="op">[</span><span class="va">mask</span>,<span class="op">]</span></span>
<span><span class="va">processedTongue</span> <span class="op">=</span> <span class="fu"><a href="https://grvanderploeg.github.io/parafac4microbiome/reference/processDataCube.html" class="external-link">processDataCube</a></span><span class="op">(</span><span class="va">temp</span>, sparsityThreshold<span class="op">=</span><span class="fl">0.50</span>, considerGroups<span class="op">=</span><span class="cn">TRUE</span>, groupVariable<span class="op">=</span><span class="st">"RFgroup"</span>, CLR<span class="op">=</span><span class="cn">TRUE</span>, centerMode<span class="op">=</span><span class="fl">1</span>, scaleMode<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Lowling</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu">parafac4microbiome</span><span class="fu">::</span><span class="va"><a href="https://grvanderploeg.github.io/parafac4microbiome/reference/vanderPloeg2024.html" class="external-link">vanderPloeg2024</a></span><span class="op">$</span><span class="va">lower_jaw_lingual</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">data</span> <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">mask</span>,,<span class="op">]</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">mode1</span> <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">mode1</span><span class="op">[</span><span class="va">mask</span>,<span class="op">]</span></span>
<span><span class="va">processedLowling</span> <span class="op">=</span> <span class="fu"><a href="https://grvanderploeg.github.io/parafac4microbiome/reference/processDataCube.html" class="external-link">processDataCube</a></span><span class="op">(</span><span class="va">temp</span>, sparsityThreshold<span class="op">=</span><span class="fl">0.50</span>, considerGroups<span class="op">=</span><span class="cn">TRUE</span>, groupVariable<span class="op">=</span><span class="st">"RFgroup"</span>, CLR<span class="op">=</span><span class="cn">TRUE</span>, centerMode<span class="op">=</span><span class="fl">1</span>, scaleMode<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Lowinter</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu">parafac4microbiome</span><span class="fu">::</span><span class="va"><a href="https://grvanderploeg.github.io/parafac4microbiome/reference/vanderPloeg2024.html" class="external-link">vanderPloeg2024</a></span><span class="op">$</span><span class="va">lower_jaw_interproximal</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">data</span> <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">mask</span>,,<span class="op">]</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">mode1</span> <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">mode1</span><span class="op">[</span><span class="va">mask</span>,<span class="op">]</span></span>
<span><span class="va">processedLowinter</span> <span class="op">=</span> <span class="fu"><a href="https://grvanderploeg.github.io/parafac4microbiome/reference/processDataCube.html" class="external-link">processDataCube</a></span><span class="op">(</span><span class="va">temp</span>, sparsityThreshold<span class="op">=</span><span class="fl">0.50</span>, considerGroups<span class="op">=</span><span class="cn">TRUE</span>, groupVariable<span class="op">=</span><span class="st">"RFgroup"</span>, CLR<span class="op">=</span><span class="cn">TRUE</span>, centerMode<span class="op">=</span><span class="fl">1</span>, scaleMode<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Upling</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu">parafac4microbiome</span><span class="fu">::</span><span class="va"><a href="https://grvanderploeg.github.io/parafac4microbiome/reference/vanderPloeg2024.html" class="external-link">vanderPloeg2024</a></span><span class="op">$</span><span class="va">upper_jaw_lingual</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">data</span> <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">mask</span>,,<span class="op">]</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">mode1</span> <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">mode1</span><span class="op">[</span><span class="va">mask</span>,<span class="op">]</span></span>
<span><span class="va">processedUpling</span> <span class="op">=</span> <span class="fu"><a href="https://grvanderploeg.github.io/parafac4microbiome/reference/processDataCube.html" class="external-link">processDataCube</a></span><span class="op">(</span><span class="va">temp</span>, sparsityThreshold<span class="op">=</span><span class="fl">0.50</span>, considerGroups<span class="op">=</span><span class="cn">TRUE</span>, groupVariable<span class="op">=</span><span class="st">"RFgroup"</span>, CLR<span class="op">=</span><span class="cn">TRUE</span>, centerMode<span class="op">=</span><span class="fl">1</span>, scaleMode<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Upinter</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu">parafac4microbiome</span><span class="fu">::</span><span class="va"><a href="https://grvanderploeg.github.io/parafac4microbiome/reference/vanderPloeg2024.html" class="external-link">vanderPloeg2024</a></span><span class="op">$</span><span class="va">upper_jaw_interproximal</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">data</span> <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">mask</span>,,<span class="op">]</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">mode1</span> <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">mode1</span><span class="op">[</span><span class="va">mask</span>,<span class="op">]</span></span>
<span><span class="va">processedUpinter</span> <span class="op">=</span> <span class="fu"><a href="https://grvanderploeg.github.io/parafac4microbiome/reference/processDataCube.html" class="external-link">processDataCube</a></span><span class="op">(</span><span class="va">temp</span>, sparsityThreshold<span class="op">=</span><span class="fl">0.50</span>, considerGroups<span class="op">=</span><span class="cn">TRUE</span>, groupVariable<span class="op">=</span><span class="st">"RFgroup"</span>, CLR<span class="op">=</span><span class="cn">TRUE</span>, centerMode<span class="op">=</span><span class="fl">1</span>, scaleMode<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Saliva</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu">parafac4microbiome</span><span class="fu">::</span><span class="va"><a href="https://grvanderploeg.github.io/parafac4microbiome/reference/vanderPloeg2024.html" class="external-link">vanderPloeg2024</a></span><span class="op">$</span><span class="va">saliva</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">data</span> <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">mask</span>,,<span class="op">]</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">mode1</span> <span class="op">=</span> <span class="va">temp</span><span class="op">$</span><span class="va">mode1</span><span class="op">[</span><span class="va">mask</span>,<span class="op">]</span></span>
<span><span class="va">processedSaliva</span> <span class="op">=</span> <span class="fu"><a href="https://grvanderploeg.github.io/parafac4microbiome/reference/processDataCube.html" class="external-link">processDataCube</a></span><span class="op">(</span><span class="va">temp</span>, sparsityThreshold<span class="op">=</span><span class="fl">0.50</span>, considerGroups<span class="op">=</span><span class="cn">TRUE</span>, groupVariable<span class="op">=</span><span class="st">"RFgroup"</span>, CLR<span class="op">=</span><span class="cn">TRUE</span>, centerMode<span class="op">=</span><span class="fl">1</span>, scaleMode<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Metabolomics stays the same</span></span>
<span><span class="va">processedMetabolomics</span> <span class="op">=</span> <span class="fu">parafac4microbiome</span><span class="fu">::</span><span class="va"><a href="https://grvanderploeg.github.io/parafac4microbiome/reference/vanderPloeg2024.html" class="external-link">vanderPloeg2024</a></span><span class="op">$</span><span class="va">metabolomics</span></span>
<span></span>
<span><span class="co"># Homogenize</span></span>
<span><span class="va">datasets</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">processedTongue</span><span class="op">$</span><span class="va">data</span>, <span class="va">processedLowling</span><span class="op">$</span><span class="va">data</span>, <span class="va">processedLowinter</span><span class="op">$</span><span class="va">data</span>, <span class="va">processedUpling</span><span class="op">$</span><span class="va">data</span>, <span class="va">processedUpinter</span><span class="op">$</span><span class="va">data</span>, <span class="va">processedSaliva</span><span class="op">$</span><span class="va">data</span>, <span class="va">processedMetabolomics</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">modes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">8</span>,<span class="fl">9</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span>,<span class="fl">11</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">12</span>,<span class="fl">13</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">14</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Z</span> <span class="op">=</span> <span class="fu"><a href="../reference/setupCMTFdata.html">setupCMTFdata</a></span><span class="op">(</span><span class="va">datasets</span>,<span class="va">modes</span>,normalize<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-selection">Model selection<a class="anchor" aria-label="anchor" href="#model-selection"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Please see the separate R scripts at https://doi.org/10.5281/zenodo.16993009 for the model selection.</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># acmtf_model = CMTFtoolbox::acmtf_opt(Z, 3, nstart = 100, method="L-BFGS", numCores=10)</span></span>
<span><span class="va">acmtf_model</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"./TIFN2/acmtf_model.RDS"</span><span class="op">)</span></span>
<span><span class="va">acmtf_model</span><span class="op">$</span><span class="va">varExp</span></span>
<span><span class="co">#&gt; [1] 26.077081 13.389771  7.070286 10.722769 12.014760 17.053897 18.279430</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h3>
<p>ACMTF was applied to the capture to dominant source of variation
across all data blocks. The model selection procedure revealed that FMS
CV dropped below 0.9 when four components were selected. Therefore, a
three-component ACMTF model was selected, explaining 26.1%, 13.4%, 7.1%,
10.7%, 12.0%, and 17.1% of the variation in the tongue, lower jaw
lingual, lower jaw interproximal, upper jaw lingual, upper jaw
interproximal, and salivary microbiome datasets, respectively, and 18.3%
of the variation in the salivary metabolomics data.</p>
<p>The Lambda-matrix of the model revealed that the first component was
predominantly local to the tongue, lower jaw lingual, upper jaw lingual,
and salivary microbiome blocks, while the second component was
predominantly local to the salivary metabolomics and tongue microbiome
blocks, and the third component was predominantly distinct to the
salivary metabolomics block. However, all components received minor
contributions from other blocks as well. MLR analysis revealed that the
first component captured uninterpretable variation, the second component
captured variation associated with a mixture of plaque% and subject age,
while the third component captured variation exclusively associated with
subject age.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">testMetadata</span><span class="op">(</span><span class="va">acmtf_model</span>, <span class="fl">1</span>, <span class="va">processedTongue</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Term   Estimate                                          CI</span></span>
<span><span class="co">#&gt; 1  plaquepercent  0.4863409  -0.00506844885613745 – 0.00604113058720496</span></span>
<span><span class="co">#&gt; 2    bomppercent  2.9652292 -0.000432781614955507 – 0.00636323992350004</span></span>
<span><span class="co">#&gt; 3 Area_delta_R30  7.5900807   0.000734950049744098 – 0.0144452114121996</span></span>
<span><span class="co">#&gt; 4         gender 86.0214570      -0.010641596321994 – 0.182684510263669</span></span>
<span><span class="co">#&gt; 5            age  9.1712962   0.000577075926033553 – 0.0177655165286259</span></span>
<span><span class="co">#&gt;      P_value   P_adjust</span></span>
<span><span class="co">#&gt; 1 0.85983387 0.85983387</span></span>
<span><span class="co">#&gt; 2 0.08511896 0.10639870</span></span>
<span><span class="co">#&gt; 3 0.03102313 0.09298174</span></span>
<span><span class="co">#&gt; 4 0.07937792 0.10639870</span></span>
<span><span class="co">#&gt; 5 0.03719270 0.09298174</span></span>
<span><span class="fu">testMetadata</span><span class="op">(</span><span class="va">acmtf_model</span>, <span class="fl">2</span>, <span class="va">processedTongue</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Term    Estimate                                          CI</span></span>
<span><span class="co">#&gt; 1  plaquepercent  -5.5322600 -0.0106693400579514 – -0.000395179879130161</span></span>
<span><span class="co">#&gt; 2    bomppercent   0.1529061  -0.00298958068906224 – 0.00329539294300932</span></span>
<span><span class="co">#&gt; 3 Area_delta_R30  -2.2288690  -0.00856850683903234 – 0.00411076892021208</span></span>
<span><span class="co">#&gt; 4         gender -22.1883942     -0.111582569602603 – 0.0672057811120825</span></span>
<span><span class="co">#&gt; 5            age  18.7122978     0.0107643465442291 – 0.0266602490737363</span></span>
<span><span class="co">#&gt;        P_value     P_adjust</span></span>
<span><span class="co">#&gt; 1 3.559350e-02 0.0889837601</span></span>
<span><span class="co">#&gt; 2 9.218108e-01 0.9218108424</span></span>
<span><span class="co">#&gt; 3 4.798015e-01 0.7715244490</span></span>
<span><span class="co">#&gt; 4 6.172196e-01 0.7715244490</span></span>
<span><span class="co">#&gt; 5 3.261655e-05 0.0001630827</span></span>
<span><span class="fu">testMetadata</span><span class="op">(</span><span class="va">acmtf_model</span>, <span class="fl">3</span>, <span class="va">processedTongue</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Term   Estimate                                         CI</span></span>
<span><span class="co">#&gt; 1  plaquepercent  0.1361253 -0.00536264865494706 – 0.00563489919269931</span></span>
<span><span class="co">#&gt; 2    bomppercent  1.4787774  -0.0018849670226254 – 0.00484252184623444</span></span>
<span><span class="co">#&gt; 3 Area_delta_R30  4.9612353  -0.00182476661145919 – 0.0117472372709829</span></span>
<span><span class="co">#&gt; 4         gender  2.2390025    -0.0934492779583765 – 0.097927282983282</span></span>
<span><span class="co">#&gt; 5            age 14.9701758   0.00646262160971828 – 0.0234777299599013</span></span>
<span><span class="co">#&gt;       P_value    P_adjust</span></span>
<span><span class="co">#&gt; 1 0.960170260 0.962351254</span></span>
<span><span class="co">#&gt; 2 0.377912728 0.629854546</span></span>
<span><span class="co">#&gt; 3 0.146554101 0.366385252</span></span>
<span><span class="co">#&gt; 4 0.962351254 0.962351254</span></span>
<span><span class="co">#&gt; 5 0.001070941 0.005354707</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lambda</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">16</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lambda</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>block<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tongue"</span>, <span class="st">"lowling"</span>, <span class="st">"lowinter"</span>, <span class="st">"upling"</span>, <span class="st">"upinter"</span>, <span class="st">"saliva"</span>, <span class="st">"metab"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>block<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">block</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tongue"</span>, <span class="st">"lowling"</span>, <span class="st">"lowinter"</span>, <span class="st">"upling"</span>, <span class="st">"upinter"</span>, <span class="st">"saliva"</span>, <span class="st">"metab"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">block</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>,y<span class="op">=</span><span class="va">value</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">block</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>,position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"ACMTF component number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Dataset"</span>,values <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/pal_hue.html" class="external-link">hue_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>,labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tongue"</span>, <span class="st">"Lower jaw, lingual"</span>, <span class="st">"Lower jaw, interproximal"</span>, <span class="st">"Upper jaw, lingual"</span>, <span class="st">"Upper jaw, interproximal"</span>, <span class="st">"Salivary microbiome"</span>, <span class="st">"Salivary metabolome"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20plot%20the%20lambda%20matrix-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Component 2 is interpretable as being related to age</span></span>
<span><span class="co"># it is mainly described by tongue + metab</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedTongue</span>, <span class="fl">2</span>, <span class="st">"age"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;            age</span></span>
<span><span class="co">#&gt; [1,] 0.4471952</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;             age</span></span>
<span><span class="co">#&gt; [1,] -0.4471952</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu">plotFeatures</span><span class="op">(</span><span class="va">processedTongue</span><span class="op">$</span><span class="va">mode2</span>, <span class="va">temp</span>, <span class="fl">2</span>, flip<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">phylum_colors</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedLowling</span>, <span class="fl">2</span>, <span class="st">"age"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;            age</span></span>
<span><span class="co">#&gt; [1,] 0.4471952</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;             age</span></span>
<span><span class="co">#&gt; [1,] -0.4471952</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="fu">plotFeatures</span><span class="op">(</span><span class="va">processedLowling</span><span class="op">$</span><span class="va">mode2</span>, <span class="va">temp</span>, <span class="fl">2</span>, flip<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">phylum_colors</span><span class="op">[</span><span class="op">-</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedLowinter</span>, <span class="fl">2</span>, <span class="st">"age"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;            age</span></span>
<span><span class="co">#&gt; [1,] 0.4471952</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;             age</span></span>
<span><span class="co">#&gt; [1,] -0.4471952</span></span>
<span><span class="va">c</span> <span class="op">=</span> <span class="fu">plotFeatures</span><span class="op">(</span><span class="va">processedLowinter</span><span class="op">$</span><span class="va">mode2</span>, <span class="va">temp</span>, <span class="fl">2</span>, flip<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">8</span>,<span class="fl">9</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedUpling</span>, <span class="fl">2</span>, <span class="st">"age"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;            age</span></span>
<span><span class="co">#&gt; [1,] 0.4471952</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;             age</span></span>
<span><span class="co">#&gt; [1,] -0.4471952</span></span>
<span><span class="va">d</span> <span class="op">=</span> <span class="fu">plotFeatures</span><span class="op">(</span><span class="va">processedUpling</span><span class="op">$</span><span class="va">mode2</span>, <span class="va">temp</span>, <span class="fl">2</span>, flip<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span>,<span class="fl">11</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedUpinter</span>, <span class="fl">2</span>, <span class="st">"age"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;            age</span></span>
<span><span class="co">#&gt; [1,] 0.4471952</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;             age</span></span>
<span><span class="co">#&gt; [1,] -0.4471952</span></span>
<span><span class="va">e</span> <span class="op">=</span> <span class="fu">plotFeatures</span><span class="op">(</span><span class="va">processedUpinter</span><span class="op">$</span><span class="va">mode2</span>, <span class="va">temp</span>, <span class="fl">2</span>, flip<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">12</span>,<span class="fl">13</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedSaliva</span>, <span class="fl">2</span>, <span class="st">"age"</span><span class="op">)</span> <span class="co"># flip</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;             age</span></span>
<span><span class="co">#&gt; [1,] -0.4471952</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;            age</span></span>
<span><span class="co">#&gt; [1,] 0.4471952</span></span>
<span><span class="va">f</span> <span class="op">=</span> <span class="fu">plotFeatures</span><span class="op">(</span><span class="va">processedSaliva</span><span class="op">$</span><span class="va">mode2</span>, <span class="va">temp</span>, <span class="fl">2</span>, flip<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">phylum_colors</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">14</span>,<span class="fl">15</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedMetabolomics</span>, <span class="fl">2</span>, <span class="st">"age"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;            age</span></span>
<span><span class="co">#&gt; [1,] 0.4471952</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;             age</span></span>
<span><span class="co">#&gt; [1,] -0.4471952</span></span>
<span></span>
<span><span class="co"># Metab</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="va">processedMetabolomics</span><span class="op">$</span><span class="va">mode2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Component_2 <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">14</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Component_2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>index<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span><span class="op">)</span>, <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g</span><span class="op">=</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Component_2</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Type</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">df</span><span class="op">$</span><span class="va">Name</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Class"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span>, legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g2</span> <span class="op">=</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Component_2</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span>,</span>
<span>             fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Type</span><span class="op">)</span>,</span>
<span>             pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Type</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://trevorldavis.com/R/ggpattern/reference/geom-docs.html" class="external-link">geom_bar_pattern</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>                   colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                   pattern <span class="op">=</span> <span class="st">"stripe"</span>,</span>
<span>                   pattern_fill <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                   pattern_density <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>                   pattern_spacing <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                   pattern_angle <span class="op">=</span> <span class="fl">45</span>,</span>
<span>                   pattern_size <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Name</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Class"</span><span class="op">)</span>,</span>
<span>         pattern <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%202%20feature%20loadings-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%202%20feature%20loadings-2.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%202%20feature%20loadings-3.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%202%20feature%20loadings-4.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%202%20feature%20loadings-5.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%202%20feature%20loadings-6.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g2</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%202%20feature%20loadings-7.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">=</span> <span class="va">processedTongue</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Comp <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">visit</span>,<span class="op">-</span><span class="va">status</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="va">processedLowling</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Comp <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">visit</span>,<span class="op">-</span><span class="va">status</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span><span class="va">c</span> <span class="op">=</span> <span class="va">processedLowinter</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Component_1 <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">visit</span>,<span class="op">-</span><span class="va">status</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">=</span> <span class="va">processedUpling</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Component_1 <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">9</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">Component_1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">e</span> <span class="op">=</span> <span class="va">processedUpinter</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Component_1 <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">11</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">Component_1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">f</span> <span class="op">=</span> <span class="va">processedSaliva</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Component_1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">13</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">Component_1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g</span> <span class="op">=</span> <span class="va">processedMetabolomics</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Component_1 <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">15</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">Component_1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%202%20time%20loadings-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%202%20time%20loadings-2.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%202%20time%20loadings-3.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%202%20time%20loadings-4.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%202%20time%20loadings-5.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%202%20time%20loadings-6.png" width="700"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%202%20time%20loadings-7.png" width="700"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Component 2 is interpretable as being related to age</span></span>
<span><span class="co"># it is mainly described by tongue + metab</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedTongue</span>, <span class="fl">3</span>, <span class="st">"age"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;           age</span></span>
<span><span class="co">#&gt; [1,] 0.545521</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;            age</span></span>
<span><span class="co">#&gt; [1,] -0.545521</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu">plotFeatures</span><span class="op">(</span><span class="va">processedTongue</span><span class="op">$</span><span class="va">mode2</span>, <span class="va">temp</span>, <span class="fl">3</span>, flip<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">phylum_colors</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedLowling</span>, <span class="fl">3</span>, <span class="st">"age"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;           age</span></span>
<span><span class="co">#&gt; [1,] 0.545521</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;            age</span></span>
<span><span class="co">#&gt; [1,] -0.545521</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="fu">plotFeatures</span><span class="op">(</span><span class="va">processedLowling</span><span class="op">$</span><span class="va">mode2</span>, <span class="va">temp</span>, <span class="fl">3</span>, flip<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">phylum_colors</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedLowinter</span>, <span class="fl">3</span>, <span class="st">"age"</span><span class="op">)</span> <span class="co"># flip</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;            age</span></span>
<span><span class="co">#&gt; [1,] -0.545521</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;           age</span></span>
<span><span class="co">#&gt; [1,] 0.545521</span></span>
<span><span class="va">c</span> <span class="op">=</span> <span class="fu">plotFeatures</span><span class="op">(</span><span class="va">processedLowinter</span><span class="op">$</span><span class="va">mode2</span>, <span class="va">temp</span>, <span class="fl">3</span>, flip<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">phylum_colors</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">8</span>,<span class="fl">9</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedUpling</span>, <span class="fl">3</span>, <span class="st">"age"</span><span class="op">)</span> <span class="co"># cor says flip, but lambda is negative -&gt; no flip</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;            age</span></span>
<span><span class="co">#&gt; [1,] -0.545521</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;           age</span></span>
<span><span class="co">#&gt; [1,] 0.545521</span></span>
<span><span class="va">d</span> <span class="op">=</span> <span class="fu">plotFeatures</span><span class="op">(</span><span class="va">processedUpling</span><span class="op">$</span><span class="va">mode2</span>, <span class="va">temp</span>, <span class="fl">3</span>, flip<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">phylum_colors</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span>,<span class="fl">11</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedUpinter</span>, <span class="fl">3</span>, <span class="st">"age"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;           age</span></span>
<span><span class="co">#&gt; [1,] 0.545521</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;            age</span></span>
<span><span class="co">#&gt; [1,] -0.545521</span></span>
<span><span class="va">e</span> <span class="op">=</span> <span class="fu">plotFeatures</span><span class="op">(</span><span class="va">processedUpinter</span><span class="op">$</span><span class="va">mode2</span>, <span class="va">temp</span>, <span class="fl">3</span>, flip<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">phylum_colors</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">12</span>,<span class="fl">13</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedSaliva</span>, <span class="fl">3</span>, <span class="st">"age"</span><span class="op">)</span> <span class="co"># flip</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;            age</span></span>
<span><span class="co">#&gt; [1,] -0.545521</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;            age</span></span>
<span><span class="co">#&gt; [1,] -0.545521</span></span>
<span><span class="va">f</span> <span class="op">=</span> <span class="fu">plotFeatures</span><span class="op">(</span><span class="va">processedSaliva</span><span class="op">$</span><span class="va">mode2</span>, <span class="va">temp</span>, <span class="fl">3</span>, flip<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">phylum_colors</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">14</span>,<span class="fl">15</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedMetabolomics</span>, <span class="fl">3</span>, <span class="st">"age"</span><span class="op">)</span> <span class="co"># flip</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;            age</span></span>
<span><span class="co">#&gt; [1,] -0.545521</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;           age</span></span>
<span><span class="co">#&gt; [1,] 0.545521</span></span>
<span></span>
<span><span class="co"># Metab</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="va">processedMetabolomics</span><span class="op">$</span><span class="va">mode2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Component_2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">14</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Component_2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>index<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span><span class="op">)</span>, <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g</span><span class="op">=</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Component_2</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Type</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">df</span><span class="op">$</span><span class="va">Name</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Class"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span>, legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g2</span> <span class="op">=</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Component_2</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span>,</span>
<span>             fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Type</span><span class="op">)</span>,</span>
<span>             pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Type</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://trevorldavis.com/R/ggpattern/reference/geom-docs.html" class="external-link">geom_bar_pattern</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>                   colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                   pattern <span class="op">=</span> <span class="st">"stripe"</span>,</span>
<span>                   pattern_fill <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                   pattern_density <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>                   pattern_spacing <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                   pattern_angle <span class="op">=</span> <span class="fl">45</span>,</span>
<span>                   pattern_size <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Name</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Class"</span><span class="op">)</span>,</span>
<span>         pattern <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%203%20feature%20loadings-1.png" width="700"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%203%20feature%20loadings-2.png" width="700"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%203%20feature%20loadings-3.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%203%20feature%20loadings-4.png" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%203%20feature%20loadings-5.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%203%20feature%20loadings-6.png" width="700"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g2</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%203%20feature%20loadings-7.png" width="700"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">=</span> <span class="va">processedTongue</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Comp <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">visit</span>,<span class="op">-</span><span class="va">status</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="va">processedLowling</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Comp <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">visit</span>,<span class="op">-</span><span class="va">status</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span><span class="va">c</span> <span class="op">=</span> <span class="va">processedLowinter</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Component_1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">visit</span>,<span class="op">-</span><span class="va">status</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">=</span> <span class="va">processedUpling</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Component_1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">9</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">Component_1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">e</span> <span class="op">=</span> <span class="va">processedUpinter</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Component_1 <span class="op">=</span> <span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">11</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">Component_1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">f</span> <span class="op">=</span> <span class="va">processedSaliva</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Component_1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">13</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">Component_1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g</span> <span class="op">=</span> <span class="va">processedMetabolomics</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Component_1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">acmtf_model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">15</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">Component_1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%203%20time%20loadings-1.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%203%20time%20loadings-2.png" width="700"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%203%20time%20loadings-3.png" width="700"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%203%20time%20loadings-4.png" width="700"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%203%20time%20loadings-5.png" width="700"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%203%20time%20loadings-6.png" width="700"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtf%20comp%203%20time%20loadings-7.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="acmtf-r">ACMTF-R<a class="anchor" aria-label="anchor" href="#acmtf-r"></a>
</h2>
<div class="section level3">
<h3 id="processing">Processing<a class="anchor" aria-label="anchor" href="#processing"></a>
</h3>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Y</span> <span class="op">=</span> <span class="va">processedTongue</span><span class="op">$</span><span class="va">mode1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">rf_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">subject</span>,<span class="va">Area_delta_R30</span>,<span class="va">day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">day</span><span class="op">==</span><span class="fl">14</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Area_delta_R30</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject)`</span></span>
<span><span class="va">Ycnt</span> <span class="op">=</span> <span class="va">Y</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span>
<span><span class="va">Ynorm</span> <span class="op">=</span> <span class="va">Ycnt</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/norm.html" class="external-link">norm</a></span><span class="op">(</span><span class="va">Ycnt</span>, <span class="st">"2"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-selection-1">Model selection<a class="anchor" aria-label="anchor" href="#model-selection-1"></a>
</h3>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Please see the separate R scripts at https://doi.org/10.5281/zenodo.16993009 for the model selection.</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">acmtfr_model80</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"./TIFN2/TIFN2_ACMTFR_model_0.8.RDS"</span><span class="op">)</span></span>
<span><span class="va">acmtfr_model80</span><span class="op">$</span><span class="va">varExp</span></span>
<span><span class="co">#&gt; [1] 9.316929 8.047419 3.577750 6.756810 6.790952 6.320588 3.025908</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="description-1">Description<a class="anchor" aria-label="anchor" href="#description-1"></a>
</h3>
<p>ACMTF-R was next applied to supervise the joint decomposition using
the percentage of sites covered in red fluorescent plaque on day 14
(RF%) as dependent variable (y). The model selection procedure revealed
that two components were optimal for pi=0.9, based on high and stable
FMS random across datasets, FMS CV values greater than 0.9, and only a
marginal increase in RMSECV compared to one component. For pi=0.85, 0.8,
and 0.5, one component was chosen, as higher-component models showed
sharply declining FMS random and FMS CV scores, suggesting poor model
stability. Subsequently, the one-component ACMTF-R model using pi=0.80
was selected for further interpretation due to balancing explaining the
independent data and predicting y. This model explained 9.3%, 8.1%,
3.6%, 6.8%, 6.8%, 6.3%, 3.0% and 52.3% of the variation in the tongue,
lower jaw lingual, lower jaw interproximal, upper jaw lingual, upper jaw
interproximal, salivary microbiome, salivary metabolome, and y,
respectively.</p>
<p>The Lambda-matrix of the model revealed that the component was
predominantly local to the tongue and lower jaw lingual microbiomes,
with moderate contributions from the upper jaw lingual, upper jaw
interproximal, and salivary microbiome blocks. As expected, MLR analysis
revealed that the component was exclusively associated with RF%.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lambda</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">acmtfr_model80</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">16</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lambda</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>block<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tongue"</span>, <span class="st">"lowling"</span>, <span class="st">"lowinter"</span>, <span class="st">"upling"</span>, <span class="st">"upinter"</span>, <span class="st">"saliva"</span>, <span class="st">"metab"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>block<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">block</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tongue"</span>, <span class="st">"lowling"</span>, <span class="st">"lowinter"</span>, <span class="st">"upling"</span>, <span class="st">"upinter"</span>, <span class="st">"saliva"</span>, <span class="st">"metab"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">block</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>,y<span class="op">=</span><span class="va">value</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">block</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>,position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"ACMTF-R component number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Dataset"</span>,values <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/pal_hue.html" class="external-link">hue_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>,labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tongue"</span>, <span class="st">"Lower jaw, lingual"</span>, <span class="st">"Lower jaw, interproximal"</span>, <span class="st">"Upper jaw, lingual"</span>, <span class="st">"Upper jaw, interproximal"</span>, <span class="st">"Salivary microbiome"</span>, <span class="st">"Salivary metabolome"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtfr%20lambda%20matrices-1.png" width="700"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">testMetadata</span><span class="op">(</span><span class="va">acmtfr_model80</span>, <span class="fl">1</span>, <span class="va">processedTongue</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Term   Estimate                                          CI</span></span>
<span><span class="co">#&gt; 1  plaquepercent  -2.353174  -0.00656449861760044 – 0.00185815139043573</span></span>
<span><span class="co">#&gt; 2    bomppercent  -2.345146 -0.00492132427908455 – 0.000231031951626678</span></span>
<span><span class="co">#&gt; 3 Area_delta_R30 -15.278510   -0.0204756794088214 – -0.0100813405804632</span></span>
<span><span class="co">#&gt; 4         gender -72.149196     -0.145433613790882 – 0.0011352227246296</span></span>
<span><span class="co">#&gt; 5            age  -1.139687  -0.00765533504288667 – 0.00537596106673432</span></span>
<span><span class="co">#&gt;        P_value     P_adjust</span></span>
<span><span class="co">#&gt; 1 2.640812e-01 3.301015e-01</span></span>
<span><span class="co">#&gt; 2 7.302173e-02 1.217029e-01</span></span>
<span><span class="co">#&gt; 3 9.298468e-07 4.649234e-06</span></span>
<span><span class="co">#&gt; 4 5.345353e-02 1.217029e-01</span></span>
<span><span class="co">#&gt; 5 7.244329e-01 7.244329e-01</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pi = 0.8</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtfr_model80</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedTongue</span>, <span class="fl">1</span>, <span class="st">"Area_delta_R30"</span><span class="op">)</span> <span class="co"># flip</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;      Area_delta_R30</span></span>
<span><span class="co">#&gt; [1,]     -0.7233091</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;      Area_delta_R30</span></span>
<span><span class="co">#&gt; [1,]      0.7233091</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu">plotFeatures</span><span class="op">(</span><span class="va">processedTongue</span><span class="op">$</span><span class="va">mode2</span>, <span class="va">temp</span>, <span class="fl">1</span>, flip<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">phylum_colors</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtfr_model80</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedLowling</span>, <span class="fl">1</span>, <span class="st">"Area_delta_R30"</span><span class="op">)</span> <span class="co"># flip</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;      Area_delta_R30</span></span>
<span><span class="co">#&gt; [1,]     -0.7233091</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;      Area_delta_R30</span></span>
<span><span class="co">#&gt; [1,]      0.7233091</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="fu">plotFeatures</span><span class="op">(</span><span class="va">processedLowling</span><span class="op">$</span><span class="va">mode2</span>, <span class="va">temp</span>, <span class="fl">1</span>, flip<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">phylum_colors</span><span class="op">[</span><span class="op">-</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtfr_model80</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedLowinter</span>, <span class="fl">1</span>, <span class="st">"Area_delta_R30"</span><span class="op">)</span> <span class="co"># flip</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;      Area_delta_R30</span></span>
<span><span class="co">#&gt; [1,]     -0.7233091</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;      Area_delta_R30</span></span>
<span><span class="co">#&gt; [1,]      0.7233091</span></span>
<span><span class="va">c</span> <span class="op">=</span> <span class="fu">plotFeatures</span><span class="op">(</span><span class="va">processedLowinter</span><span class="op">$</span><span class="va">mode2</span>, <span class="va">temp</span>, <span class="fl">1</span>, flip<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">phylum_colors</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtfr_model80</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">8</span>,<span class="fl">9</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedUpling</span>, <span class="fl">1</span>, <span class="st">"Area_delta_R30"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;      Area_delta_R30</span></span>
<span><span class="co">#&gt; [1,]      0.7233091</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;      Area_delta_R30</span></span>
<span><span class="co">#&gt; [1,]     -0.7233091</span></span>
<span><span class="va">d</span> <span class="op">=</span> <span class="fu">plotFeatures</span><span class="op">(</span><span class="va">processedUpling</span><span class="op">$</span><span class="va">mode2</span>, <span class="va">temp</span>, <span class="fl">1</span>, flip<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">phylum_colors</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtfr_model80</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span>,<span class="fl">11</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedUpinter</span>, <span class="fl">1</span>, <span class="st">"Area_delta_R30"</span><span class="op">)</span> <span class="co"># flip</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;      Area_delta_R30</span></span>
<span><span class="co">#&gt; [1,]     -0.7233091</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;      Area_delta_R30</span></span>
<span><span class="co">#&gt; [1,]      0.7233091</span></span>
<span><span class="va">e</span> <span class="op">=</span> <span class="fu">plotFeatures</span><span class="op">(</span><span class="va">processedUpinter</span><span class="op">$</span><span class="va">mode2</span>, <span class="va">temp</span>, <span class="fl">1</span>, flip<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">phylum_colors</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtfr_model80</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">12</span>,<span class="fl">13</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedSaliva</span>, <span class="fl">1</span>, <span class="st">"Area_delta_R30"</span><span class="op">)</span> <span class="co"># flip</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;      Area_delta_R30</span></span>
<span><span class="co">#&gt; [1,]     -0.7233091</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;      Area_delta_R30</span></span>
<span><span class="co">#&gt; [1,]      0.7233091</span></span>
<span><span class="va">f</span> <span class="op">=</span> <span class="fu">plotFeatures</span><span class="op">(</span><span class="va">processedSaliva</span><span class="op">$</span><span class="va">mode2</span>, <span class="va">temp</span>, <span class="fl">1</span>, flip<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">phylum_colors</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Metab</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">Fac</span> <span class="op">=</span> <span class="va">acmtfr_model80</span><span class="op">$</span><span class="va">Fac</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">14</span>,<span class="fl">15</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">testFeatures</span><span class="op">(</span><span class="va">temp</span>, <span class="va">processedMetabolomics</span>, <span class="fl">1</span>, <span class="st">"Area_delta_R30"</span><span class="op">)</span> <span class="co"># no flip</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, RFgroup)`</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(subject, age, gender)`</span></span>
<span><span class="co">#&gt; [1] "Positive loadings:"</span></span>
<span><span class="co">#&gt;      Area_delta_R30</span></span>
<span><span class="co">#&gt; [1,]      0.7233091</span></span>
<span><span class="co">#&gt; [1] "Negative loadings:"</span></span>
<span><span class="co">#&gt;      Area_delta_R30</span></span>
<span><span class="co">#&gt; [1,]     -0.7233091</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="va">processedMetabolomics</span><span class="op">$</span><span class="va">mode2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Component_2 <span class="op">=</span> <span class="va">acmtfr_model80</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">14</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Component_2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>index<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span><span class="op">)</span>, <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g</span> <span class="op">=</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Component_2</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">index</span><span class="op">)</span>,</span>
<span>             fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Type</span><span class="op">)</span>,</span>
<span>             pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Type</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://trevorldavis.com/R/ggpattern/reference/geom-docs.html" class="external-link">geom_bar_pattern</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>                   colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                   pattern <span class="op">=</span> <span class="st">"stripe"</span>,</span>
<span>                   pattern_fill <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                   pattern_density <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>                   pattern_spacing <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                   pattern_angle <span class="op">=</span> <span class="fl">45</span>,</span>
<span>                   pattern_size <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Name</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Class"</span><span class="op">)</span>,</span>
<span>         pattern <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtfr%20feature%20mode-1.png" width="700"></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtfr%20feature%20mode-2.png" width="700"></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtfr%20feature%20mode-3.png" width="700"></p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtfr%20feature%20mode-4.png" width="700"></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtfr%20feature%20mode-5.png" width="700"></p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtfr%20feature%20mode-6.png" width="700"></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtfr%20feature%20mode-7.png" width="700"></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">=</span> <span class="va">processedTongue</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Comp <span class="op">=</span> <span class="va">acmtfr_model80</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">visit</span>,<span class="op">-</span><span class="va">status</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="va">processedLowling</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Component_1 <span class="op">=</span> <span class="va">acmtfr_model80</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">Component_1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">c</span> <span class="op">=</span> <span class="va">processedLowinter</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Component_1 <span class="op">=</span> <span class="va">acmtfr_model80</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">Component_1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">=</span> <span class="va">processedUpling</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Component_1 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">acmtfr_model80</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">9</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">Component_1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">e</span> <span class="op">=</span> <span class="va">processedUpinter</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Component_1 <span class="op">=</span> <span class="va">acmtfr_model80</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">11</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">Component_1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">f</span> <span class="op">=</span> <span class="va">processedSaliva</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Comp <span class="op">=</span> <span class="va">acmtfr_model80</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">13</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">visit</span>,<span class="op">-</span><span class="va">status</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">g</span> <span class="op">=</span> <span class="va">processedMetabolomics</span><span class="op">$</span><span class="va">mode3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Comp <span class="op">=</span> <span class="va">acmtfr_model80</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">15</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, day<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">14</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">visit</span>,<span class="op">-</span><span class="va">status</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">day</span>,y<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">0</span>, xmax <span class="op">=</span> <span class="fl">14</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, colour <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time point [days]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Loading"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">a</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtfr%20time%20mode-1.png" width="700"></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtfr%20time%20mode-2.png" width="700"></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtfr%20time%20mode-3.png" width="700"></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtfr%20time%20mode-4.png" width="700"></p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtfr%20time%20mode-5.png" width="700"></p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtfr%20time%20mode-6.png" width="700"></p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span></span></code></pre></div>
<p><img src="TIFN2_files/figure-html/acmtfr%20time%20mode-7.png" width="700">
Across the microbiome datasets, consistently positively loaded taxa
including Aggregatibacter, Fusobacterium, Leptotrichia,
Peptostreptococcus, Porphyromonas, and Fusobacterium nucleatum were
enriched in high responders and depleted in low responders. Conversely,
consistently negatively loaded taxa including Kingella, Lautropia,
Prevotella, Rothia, Streptococcus, and Veillonella were enriched in low
responders and enriched in high responders. Overall, inter-subject
differences due to RF% remained relatively constant, with a small
increase during the intervention.</p>
<p>Higher RF% was associated with elevated levels of amino acids,
including valine, isoleucine, and methionine. Conversely, individuals
with lower RF% exhibited higher levels of peptides (e.g., uridine,
inosine, and guanosine) and some carbohydrates (e.g., glucose and
maltose). The time mode loadings indicate that inter-subject differences
due to the intervention remained relatively constant.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Geert Roelof van der Ploeg, University of Amsterdam.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
