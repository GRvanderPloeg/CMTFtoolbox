<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>ACMTF_simulation • CMTFtoolbox</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ACMTF_simulation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CMTFtoolbox</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/ACMTF_simulation.html">ACMTF_simulation</a></li>
    <li><a class="dropdown-item" href="../articles/CMTF_simulation.html">CMTF_simulation</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>ACMTF_simulation</h1>
            
      

      <div class="d-none name"><code>ACMTF_simulation.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">postprocessModel</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">Anorm</span>, <span class="va">Fac</span>, <span class="va">Z</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">numComponents</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">numDatasets</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Z</span><span class="op">$</span><span class="va">object</span><span class="op">)</span></span>
<span>  <span class="va">numModes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">Z</span><span class="op">$</span><span class="va">modes</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">lambdaOutput</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">numDatasets</span>, <span class="va">numComponents</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">matchScore</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">numComponents</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Fac</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">numModes</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">lambdas</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Fac</span><span class="op">[[</span><span class="va">numModes</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">normalizedModel</span> <span class="op">=</span> <span class="fu"><a href="../reference/normalizeFac.html">normalizeFac</a></span><span class="op">(</span><span class="va">Fac</span>, <span class="va">Z</span><span class="op">$</span><span class="va">modes</span><span class="op">)</span></span>
<span>    <span class="va">lambdas</span> <span class="op">=</span> <span class="va">normalizedModel</span><span class="op">$</span><span class="va">normsPerDataset</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Check all permutations of columns in the model</span></span>
<span>  <span class="va">proposedMatchScores</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">numComponents</span>, <span class="va">numComponents</span><span class="op">)</span><span class="op">)</span> <span class="co"># rows: model, columns: sim</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numComponents</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">a_hat</span> <span class="op">=</span> <span class="va">Fac</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numComponents</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">a</span> <span class="op">=</span> <span class="va">Anorm</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span></span>
<span>      <span class="va">proposedMatchScores</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">a_hat</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">a</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/norm.html" class="external-link">norm</a></span><span class="op">(</span><span class="va">a_hat</span>, <span class="st">"2"</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/norm.html" class="external-link">norm</a></span><span class="op">(</span><span class="va">a</span>, <span class="st">"2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Per component, find the best matching component from the simulated scores</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numComponents</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">idx</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">proposedMatchScores</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">matchScore</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="va">proposedMatchScores</span><span class="op">[</span><span class="va">idx</span>,<span class="va">j</span><span class="op">]</span></span>
<span>    <span class="va">lambdaOutput</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="va">lambdas</span><span class="op">[</span>,<span class="va">idx</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"matchScore"</span><span class="op">=</span><span class="va">matchScore</span>, <span class="st">"lambda"</span><span class="op">=</span><span class="va">lambdaOutput</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sideBySidePlot</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">Anorm</span>, <span class="va">cmtf_result</span>, <span class="va">acmtf_result</span>, <span class="va">Z</span>, <span class="va">overallTitle</span><span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">numComponents</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">cmtf_result</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">cmtf_matchScores</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">acmtf_matchScores</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">cmtf_lambdas</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">acmtf_lambdas</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">acmtf_result</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">cmtf_matchScores</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">postprocessModel</span><span class="op">(</span><span class="va">Anorm</span>, <span class="va">cmtf_result</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Fac</span>, <span class="va">Z</span><span class="op">)</span><span class="op">$</span><span class="va">matchScore</span><span class="op">)</span></span>
<span>    <span class="va">acmtf_matchScores</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">postprocessModel</span><span class="op">(</span><span class="va">Anorm</span>, <span class="va">acmtf_result</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Fac</span>, <span class="va">Z</span><span class="op">)</span><span class="op">$</span><span class="va">matchScore</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">cmtf_lambdas</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">postprocessModel</span><span class="op">(</span><span class="va">Anorm</span>, <span class="va">cmtf_result</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Fac</span>, <span class="va">Z</span><span class="op">)</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span></span>
<span>    <span class="va">acmtf_lambdas</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">postprocessModel</span><span class="op">(</span><span class="va">Anorm</span>, <span class="va">acmtf_result</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Fac</span>, <span class="va">Z</span><span class="op">)</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">cmtf_matchScores</span> <span class="op">=</span> <span class="fu">bind_cols</span><span class="op">(</span><span class="va">cmtf_matchScores</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">acmtf_matchScores</span> <span class="op">=</span> <span class="fu">bind_cols</span><span class="op">(</span><span class="va">acmtf_matchScores</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">cmtf_lambdas</span> <span class="op">=</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">cmtf_lambdas</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">acmtf_lambdas</span> <span class="op">=</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">acmtf_lambdas</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cmtf_matchScores</span><span class="op">)</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">numComponents</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">acmtf_matchScores</span><span class="op">)</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">numComponents</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cmtf_lambdas</span><span class="op">)</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">numComponents</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">acmtf_lambdas</span><span class="op">)</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">numComponents</span></span>
<span>  </span>
<span>  <span class="va">a</span><span class="op">=</span><span class="va">cmtf_lambdas</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lambda"</span>,<span class="st">"sigma"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cmtf_result</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="va">type</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">type</span>,<span class="va">name</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarize</span><span class="op">(</span>m<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,s<span class="op">=</span><span class="fu">plotrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotrix/man/std.error.html" class="external-link">std.error</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>,y<span class="op">=</span><span class="va">m</span>,fill<span class="op">=</span><span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>,position<span class="op">=</span><span class="st">"dodge"</span>,col<span class="op">=</span><span class="st">"black"</span>,width<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_pointrange</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin<span class="op">=</span><span class="va">m</span><span class="op">-</span><span class="va">s</span>,ymax<span class="op">=</span><span class="va">m</span><span class="op">+</span><span class="va">s</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">1</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span>width<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"CMTF"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"top"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">"Component"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Value"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">b</span><span class="op">=</span><span class="va">acmtf_lambdas</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lambda"</span>,<span class="st">"sigma"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">acmtf_result</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="va">type</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">type</span>,<span class="va">name</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarize</span><span class="op">(</span>m<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,s<span class="op">=</span><span class="fu">plotrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotrix/man/std.error.html" class="external-link">std.error</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>,y<span class="op">=</span><span class="va">m</span>,fill<span class="op">=</span><span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>,position<span class="op">=</span><span class="st">"dodge"</span>,col<span class="op">=</span><span class="st">"black"</span>,width<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_pointrange</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin<span class="op">=</span><span class="va">m</span><span class="op">-</span><span class="va">s</span>,ymax<span class="op">=</span><span class="va">m</span><span class="op">+</span><span class="va">s</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">1</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span>width<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"ACMTF"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"top"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">"Component"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Value"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">c</span><span class="op">=</span><span class="va">cmtf_matchScores</span> <span class="op">%&gt;%</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>,y<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">"Component"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Match score"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylim</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"CMTF"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">d</span><span class="op">=</span><span class="va">acmtf_matchScores</span> <span class="op">%&gt;%</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>,y<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">"Component"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Match score"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylim</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"ACMTF"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">plot</span> <span class="op">=</span> <span class="fu">ggarrange</span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span>,<span class="va">c</span>,<span class="va">d</span><span class="op">)</span></span>
<span>  <span class="fu">annotate_figure</span><span class="op">(</span><span class="va">plot</span>, top <span class="op">=</span> <span class="fu">text_grob</span><span class="op">(</span><span class="va">overallTitle</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette we compare Advanced Coupled Matrix and Tensor
Factorization (ACMTF) with Coupled Matrix and Tensor Factorization
(CMTF) using a simulation as described in case 1 of <a href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-15-239" class="external-link">Acar
et al., 2014</a>. Due to limitations in computational time allowed to
render this vignette, we create only 3 randomly initialized models and
use slightly less strict convergence parameters.</p>
<p>We create random components that we reinflate into data blocks. We
add 5% noise to each data block to make the error structure a bit more
complicated. The number of shared and distinct components differ per
simulation.</p>
</div>
<div class="section level2">
<h2 id="simulation">Simulation<a class="anchor" aria-label="anchor" href="#simulation"></a>
</h2>
<p>We create a tensor and a matrix that a linked in the subject mode
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
= [1 0 1] and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
= [1 1 0], meaning that component 1 is shared between the blocks,
component 2 is distinct for the matrix and component 3 is distinct for
the tensor.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">R</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="va">I</span> <span class="op">=</span> <span class="fl">50</span></span>
<span><span class="va">J</span> <span class="op">=</span> <span class="fl">30</span></span>
<span><span class="va">K</span> <span class="op">=</span> <span class="fl">40</span></span>
<span><span class="va">M</span> <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="va">modes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">I</span><span class="op">*</span><span class="va">R</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">I</span>, <span class="va">R</span><span class="op">)</span><span class="op">)</span>  <span class="co"># shared subject mode</span></span>
<span><span class="va">Anorm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html" class="external-link">sweep</a></span><span class="op">(</span><span class="va">A</span>, <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">A</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/norm.html" class="external-link">norm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"F"</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>, FUN<span class="op">=</span><span class="st">"/"</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">J</span><span class="op">*</span><span class="va">R</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">J</span>, <span class="va">R</span><span class="op">)</span><span class="op">)</span>  <span class="co"># distinct feature mode of X1</span></span>
<span><span class="va">Bnorm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html" class="external-link">sweep</a></span><span class="op">(</span><span class="va">B</span>, <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">B</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/norm.html" class="external-link">norm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"F"</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>, FUN<span class="op">=</span><span class="st">"/"</span><span class="op">)</span></span>
<span><span class="va">C</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">K</span><span class="op">*</span><span class="va">R</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">K</span>, <span class="va">R</span><span class="op">)</span><span class="op">)</span>  <span class="co"># distinct condition mode of X1</span></span>
<span><span class="va">Cnorm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html" class="external-link">sweep</a></span><span class="op">(</span><span class="va">C</span>, <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">C</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/norm.html" class="external-link">norm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"F"</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>, FUN<span class="op">=</span><span class="st">"/"</span><span class="op">)</span></span>
<span><span class="va">D</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">M</span><span class="op">*</span><span class="va">R</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">M</span>, <span class="va">R</span><span class="op">)</span><span class="op">)</span>  <span class="co"># distinct feature mode of X2</span></span>
<span><span class="va">Dnorm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html" class="external-link">sweep</a></span><span class="op">(</span><span class="va">D</span>, <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">D</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/norm.html" class="external-link">norm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"F"</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>, FUN<span class="op">=</span><span class="st">"/"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lambdas</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">I</span>, <span class="va">J</span>, <span class="va">K</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">0L</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">I</span>, <span class="va">M</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">R</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">df1</span> <span class="op">=</span> <span class="va">df1</span> <span class="op">+</span> <span class="va">lambdas</span><span class="op">[</span><span class="fl">1</span>,<span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="../reference/reinflateTensor.html">reinflateTensor</a></span><span class="op">(</span><span class="va">Anorm</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, <span class="va">Bnorm</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, <span class="va">Cnorm</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">df2</span> <span class="op">=</span> <span class="va">df2</span> <span class="op">+</span> <span class="va">lambdas</span><span class="op">[</span><span class="fl">2</span>,<span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="../reference/reinflateMatrix.html">reinflateMatrix</a></span><span class="op">(</span><span class="va">Anorm</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, <span class="va">Dnorm</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">df1</span> <span class="op">=</span> <span class="fu">as.tensor</span><span class="op">(</span><span class="va">df1</span><span class="op">)</span></span>
<span><span class="va">df2</span> <span class="op">=</span> <span class="fu">as.tensor</span><span class="op">(</span><span class="va">df2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add noise</span></span>
<span><span class="va">df1_noise</span> <span class="op">=</span> <span class="fu">as.tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">I</span><span class="op">*</span><span class="va">J</span><span class="op">*</span><span class="va">K</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">I</span>,<span class="va">J</span>,<span class="va">K</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df2_noise</span> <span class="op">=</span> <span class="fu">as.tensor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">I</span><span class="op">*</span><span class="va">M</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">I</span>,<span class="va">M</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">X1</span> <span class="op">=</span> <span class="va">df1</span> <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="va">df1_noise</span> <span class="op">*</span> <span class="fu">fnorm</span><span class="op">(</span><span class="va">df1</span><span class="op">)</span> <span class="op">/</span> <span class="fu">fnorm</span><span class="op">(</span><span class="va">df1_noise</span><span class="op">)</span></span>
<span><span class="va">X2</span> <span class="op">=</span> <span class="va">df2</span> <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="va">df2_noise</span> <span class="op">*</span> <span class="fu">fnorm</span><span class="op">(</span><span class="va">df2</span><span class="op">)</span> <span class="op">/</span> <span class="fu">fnorm</span><span class="op">(</span><span class="va">df2_noise</span><span class="op">)</span></span>
<span></span>
<span><span class="va">datasets</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">X1</span><span class="op">@</span><span class="va">data</span>, <span class="va">X2</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">Z</span> <span class="op">=</span> <span class="fu"><a href="../reference/setupCMTFdata.html">setupCMTFdata</a></span><span class="op">(</span><span class="va">datasets</span>, <span class="va">modes</span>, normalize<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cmtf_result</span> <span class="op">=</span> <span class="fu"><a href="../reference/cmtf_opt.html">cmtf_opt</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">3</span>, nstart<span class="op">=</span><span class="fl">3</span>, rel_tol<span class="op">=</span><span class="fl">1e-8</span>, grad_tol<span class="op">=</span><span class="fl">1e-8</span>, allOutput<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">acmtf_result</span> <span class="op">=</span> <span class="fu"><a href="../reference/acmtf_opt.html">acmtf_opt</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">3</span>, nstart<span class="op">=</span><span class="fl">3</span>, rel_tol<span class="op">=</span><span class="fl">1e-8</span>, grad_tol<span class="op">=</span><span class="fl">1e-8</span>, allOutput<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">##               [,1]         [,2]         [,3]</span></span>
<span><span class="co">##  [1,] -0.086594029  0.038899977  0.099652887</span></span>
<span><span class="co">##  [2,] -0.033551203 -0.007214259 -0.035949012</span></span>
<span><span class="co">##  [3,]  0.240306363  0.002628074  0.034474712</span></span>
<span><span class="co">##  [4,]  0.011431766  0.214353370  0.049103249</span></span>
<span><span class="co">##  [5,]  0.020118181 -0.033651550  0.133387272</span></span>
<span><span class="co">##  [6,]  0.263277920  0.252139986  0.006431435</span></span>
<span><span class="co">##  [7,]  0.071485280 -0.240895982  0.109921684</span></span>
<span><span class="co">##  [8,] -0.195287665  0.084663630  0.233572555</span></span>
<span><span class="co">##  [9,] -0.106007976  0.017589051  0.053564287</span></span>
<span><span class="co">## [10,] -0.067636604  0.031004948 -0.128547868</span></span>
<span><span class="co">## [11,]  0.189586137  0.066039127  0.080729992</span></span>
<span><span class="co">## [12,]  0.054788699 -0.075262955 -0.085604023</span></span>
<span><span class="co">## [13,]  0.061749318 -0.047732419  0.226276131</span></span>
<span><span class="co">## [14,]  0.018106753 -0.159570961  0.007561584</span></span>
<span><span class="co">## [15,] -0.086426321 -0.167978852 -0.072163915</span></span>
<span><span class="co">## [16,]  0.275767990  0.060941853 -0.042320720</span></span>
<span><span class="co">## [17,]  0.076593724  0.071681291 -0.015339635</span></span>
<span><span class="co">## [18,] -0.301255843 -0.011557650  0.089619922</span></span>
<span><span class="co">## [19,]  0.108730796  0.147090685  0.119040747</span></span>
<span><span class="co">## [20,] -0.072797883  0.317631150  0.143092697</span></span>
<span><span class="co">## [21,] -0.165800063 -0.085319501 -0.016338152</span></span>
<span><span class="co">## [22,] -0.034006453 -0.358991967  0.132140944</span></span>
<span><span class="co">## [23,] -0.159092977  0.151247167  0.068770014</span></span>
<span><span class="co">## [24,] -0.112161231 -0.113389590  0.035389085</span></span>
<span><span class="co">## [25,] -0.095977353 -0.111015771 -0.258581042</span></span>
<span><span class="co">## [26,] -0.259505843  0.150281781  0.091071980</span></span>
<span><span class="co">## [27,]  0.128983007 -0.041863431 -0.032864289</span></span>
<span><span class="co">## [28,]  0.023222533 -0.188301148 -0.010992973</span></span>
<span><span class="co">## [29,] -0.174114475  0.022372943  0.134007921</span></span>
<span><span class="co">## [30,]  0.194305313 -0.015259373  0.010300173</span></span>
<span><span class="co">## [31,]  0.065244315  0.002330878 -0.202068583</span></span>
<span><span class="co">## [32,] -0.043932314  0.055088806 -0.062873941</span></span>
<span><span class="co">## [33,]  0.139564334 -0.049321673 -0.005560690</span></span>
<span><span class="co">## [34,]  0.135451879  0.101983776  0.059013895</span></span>
<span><span class="co">## [35,]  0.125828371 -0.026364501  0.286825338</span></span>
<span><span class="co">## [36,]  0.104896132  0.057776521 -0.157879465</span></span>
<span><span class="co">## [37,]  0.086426448  0.172096667  0.203952490</span></span>
<span><span class="co">## [38,] -0.009330883  0.063984756 -0.102720678</span></span>
<span><span class="co">## [39,] -0.048590234 -0.051250969 -0.267481187</span></span>
<span><span class="co">## [40,] -0.059636183  0.177805567  0.201320596</span></span>
<span><span class="co">## [41,] -0.107975093  0.151378287 -0.097657248</span></span>
<span><span class="co">## [42,] -0.030517605  0.087239655  0.037018477</span></span>
<span><span class="co">## [43,] -0.195595402  0.026336173  0.219972239</span></span>
<span><span class="co">## [44,]  0.336382205 -0.085949823  0.211782685</span></span>
<span><span class="co">## [45,]  0.187858772  0.220426705  0.223581149</span></span>
<span><span class="co">## [46,] -0.174422101 -0.097759357  0.074288986</span></span>
<span><span class="co">## [47,] -0.061598867  0.336700838  0.204351734</span></span>
<span><span class="co">## [48,] -0.072092866  0.235257348 -0.095920184</span></span>
<span><span class="co">## [49,]  0.119320474 -0.032200742 -0.293638088</span></span>
<span><span class="co">## [50,] -0.013208669 -0.159412538  0.179742682</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">##               [,1]         [,2]        [,3]</span></span>
<span><span class="co">##  [1,] -0.153451544  0.257347356  0.02520481</span></span>
<span><span class="co">##  [2,] -0.149809300  0.053196932  0.05130770</span></span>
<span><span class="co">##  [3,] -0.064577248  0.134708681  0.26025651</span></span>
<span><span class="co">##  [4,]  0.196783684 -0.082314323 -0.10908173</span></span>
<span><span class="co">##  [5,]  0.023399721  0.032921486 -0.20962024</span></span>
<span><span class="co">##  [6,]  0.054305679 -0.198542828  0.35451683</span></span>
<span><span class="co">##  [7,] -0.109752214  0.118153330 -0.09351548</span></span>
<span><span class="co">##  [8,]  0.072351618 -0.132120750 -0.15301396</span></span>
<span><span class="co">##  [9,] -0.190073904  0.003997541 -0.26245903</span></span>
<span><span class="co">## [10,]  0.073040240 -0.210608802 -0.27194541</span></span>
<span><span class="co">## [11,] -0.204729323 -0.121319171 -0.12211473</span></span>
<span><span class="co">## [12,]  0.204458769  0.374312161  0.13088483</span></span>
<span><span class="co">## [13,]  0.244958285  0.081334538  0.23431810</span></span>
<span><span class="co">## [14,] -0.630700167 -0.005618549  0.14954470</span></span>
<span><span class="co">## [15,]  0.081235040  0.099123233 -0.07727693</span></span>
<span><span class="co">## [16,] -0.058249316  0.040945798  0.01288460</span></span>
<span><span class="co">## [17,] -0.123859969  0.253783356 -0.14898307</span></span>
<span><span class="co">## [18,]  0.094168110 -0.018869884 -0.15136261</span></span>
<span><span class="co">## [19,] -0.101235218  0.296378678  0.18723710</span></span>
<span><span class="co">## [20,] -0.071932518  0.238232564 -0.21465171</span></span>
<span><span class="co">## [21,]  0.041558484 -0.045094981  0.41362305</span></span>
<span><span class="co">## [22,] -0.013111745 -0.259773295 -0.01907422</span></span>
<span><span class="co">## [23,]  0.006851651 -0.193902735  0.04540979</span></span>
<span><span class="co">## [24,] -0.414031060  0.228831661 -0.15653037</span></span>
<span><span class="co">## [25,]  0.143852501 -0.156137640 -0.12069890</span></span>
<span><span class="co">## [26,]  0.213259396  0.131754054 -0.27857607</span></span>
<span><span class="co">## [27,] -0.007289661 -0.071472576 -0.03852906</span></span>
<span><span class="co">## [28,] -0.059909968 -0.204113867  0.08848084</span></span>
<span><span class="co">## [29,] -0.085205930  0.386840869  0.06880950</span></span>
<span><span class="co">## [30,]  0.089483037 -0.098804999 -0.16511577</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[3]]</span></span>
<span><span class="co">##               [,1]         [,2]         [,3]</span></span>
<span><span class="co">##  [1,]  0.131753952  0.028215092  0.034863407</span></span>
<span><span class="co">##  [2,]  0.083795395 -0.281802902  0.178603345</span></span>
<span><span class="co">##  [3,] -0.249026317 -0.222688840 -0.195979308</span></span>
<span><span class="co">##  [4,]  0.189815307  0.080080586  0.096481853</span></span>
<span><span class="co">##  [5,]  0.030077683  0.012901829 -0.076951644</span></span>
<span><span class="co">##  [6,] -0.317532533 -0.032234381  0.100317980</span></span>
<span><span class="co">##  [7,]  0.016768132  0.232372977 -0.008938180</span></span>
<span><span class="co">##  [8,]  0.226851665 -0.001577047  0.092579730</span></span>
<span><span class="co">##  [9,]  0.110722131 -0.119219344  0.196100508</span></span>
<span><span class="co">## [10,] -0.080760855  0.223142090  0.001549209</span></span>
<span><span class="co">## [11,]  0.062782321  0.102070356  0.149289237</span></span>
<span><span class="co">## [12,]  0.093353525 -0.168799747 -0.174038171</span></span>
<span><span class="co">## [13,]  0.057654403 -0.015347723 -0.105704054</span></span>
<span><span class="co">## [14,] -0.014846356 -0.262667393  0.222911958</span></span>
<span><span class="co">## [15,] -0.266945225  0.156795844  0.056024214</span></span>
<span><span class="co">## [16,]  0.014614050 -0.017086930 -0.301175857</span></span>
<span><span class="co">## [17,] -0.180091838 -0.435763555 -0.200160632</span></span>
<span><span class="co">## [18,] -0.105596952 -0.008209058 -0.029629683</span></span>
<span><span class="co">## [19,]  0.018828913  0.021688305  0.127025488</span></span>
<span><span class="co">## [20,]  0.255619814  0.155896239 -0.014796327</span></span>
<span><span class="co">## [21,]  0.086790174 -0.008091628  0.091574707</span></span>
<span><span class="co">## [22,]  0.081415069  0.050448647  0.141038590</span></span>
<span><span class="co">## [23,] -0.007923285 -0.102078806  0.244861264</span></span>
<span><span class="co">## [24,] -0.217092440 -0.009389733  0.007697350</span></span>
<span><span class="co">## [25,] -0.382373201  0.060784216 -0.007967001</span></span>
<span><span class="co">## [26,] -0.257713736  0.278239689 -0.257582755</span></span>
<span><span class="co">## [27,]  0.022393642  0.006361425  0.014553229</span></span>
<span><span class="co">## [28,]  0.292929777  0.210554904 -0.084143453</span></span>
<span><span class="co">## [29,]  0.064660127 -0.185947584 -0.143396133</span></span>
<span><span class="co">## [30,] -0.015104488 -0.291713570 -0.026232803</span></span>
<span><span class="co">## [31,] -0.141123720  0.087771939  0.148850134</span></span>
<span><span class="co">## [32,] -0.160469111 -0.082945411 -0.292349310</span></span>
<span><span class="co">## [33,] -0.113931144  0.107914810 -0.062305514</span></span>
<span><span class="co">## [34,]  0.232485428  0.047004332  0.017697195</span></span>
<span><span class="co">## [35,] -0.141199190 -0.057407411 -0.131866001</span></span>
<span><span class="co">## [36,]  0.074778586  0.150881794  0.048948197</span></span>
<span><span class="co">## [37,] -0.029084429  0.256676163  0.060146977</span></span>
<span><span class="co">## [38,] -0.012285495  0.120596600 -0.004683040</span></span>
<span><span class="co">## [39,] -0.071650522 -0.049406376 -0.362105060</span></span>
<span><span class="co">## [40,] -0.004010819 -0.034384675  0.377600954</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[4]]</span></span>
<span><span class="co">##              [,1]         [,2]        [,3]</span></span>
<span><span class="co">##  [1,] -0.04661445  0.008388786 -0.05771309</span></span>
<span><span class="co">##  [2,]  0.15386079  0.046333402  0.22063998</span></span>
<span><span class="co">##  [3,]  0.06187249  0.042380340  0.03702220</span></span>
<span><span class="co">##  [4,]  0.24451814 -0.254554394 -0.08974370</span></span>
<span><span class="co">##  [5,]  0.18682014  0.114108841  0.19775647</span></span>
<span><span class="co">##  [6,] -0.06375464  0.331243432  0.25167724</span></span>
<span><span class="co">##  [7,]  0.07936502  0.109762257  0.14870728</span></span>
<span><span class="co">##  [8,] -0.20620760 -0.272326409 -0.33933919</span></span>
<span><span class="co">##  [9,]  0.20838877 -0.101341807  0.02785057</span></span>
<span><span class="co">## [10,] -0.10898288  0.085625191  0.06452466</span></span>
<span><span class="co">## [11,]  0.56715205 -0.154435211  0.01893489</span></span>
<span><span class="co">## [12,] -0.36285518 -0.518549228 -0.55273156</span></span>
<span><span class="co">## [13,] -0.11581905  0.219443842  0.16482516</span></span>
<span><span class="co">## [14,]  0.20339834 -0.203098960 -0.03965445</span></span>
<span><span class="co">## [15,]  0.12582949 -0.134221201 -0.08679272</span></span>
<span><span class="co">## [16,] -0.15115122  0.360891611  0.21313623</span></span>
<span><span class="co">## [17,] -0.22019101 -0.187370388 -0.25318749</span></span>
<span><span class="co">## [18,]  0.02223881  0.201791831  0.19054485</span></span>
<span><span class="co">## [19,]  0.01075990 -0.303985028 -0.35049026</span></span>
<span><span class="co">## [20,] -0.41504209 -0.081859076 -0.28824042</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[5]]</span></span>
<span><span class="co">##           [,1]          [,2]          [,3]</span></span>
<span><span class="co">## [1,] 0.7047457 -0.0000102182 -0.7050103535</span></span>
<span><span class="co">## [2,] 0.7042262  0.7059553888  0.0003441839</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[1]]</span></span>
<span><span class="co">##               [,1]         [,2]         [,3]</span></span>
<span><span class="co">##  [1,] -0.086659369 -0.037906136  0.099668767</span></span>
<span><span class="co">##  [2,] -0.033526470  0.007219697 -0.035952695</span></span>
<span><span class="co">##  [3,]  0.240279351 -0.003820815  0.034475268</span></span>
<span><span class="co">##  [4,]  0.011424481 -0.214345972  0.049129029</span></span>
<span><span class="co">##  [5,]  0.020018825  0.034280843  0.133398140</span></span>
<span><span class="co">##  [6,]  0.263302770 -0.253841277  0.006415777</span></span>
<span><span class="co">##  [7,]  0.071374934  0.241293115  0.109927797</span></span>
<span><span class="co">##  [8,] -0.195440285 -0.082370151  0.233605435</span></span>
<span><span class="co">##  [9,] -0.106042430 -0.016710866  0.053583199</span></span>
<span><span class="co">## [10,] -0.067540592 -0.031331323 -0.128541935</span></span>
<span><span class="co">## [11,]  0.189534718 -0.066757249  0.080693922</span></span>
<span><span class="co">## [12,]  0.054840054  0.074561070 -0.085594903</span></span>
<span><span class="co">## [13,]  0.061580571  0.048631564  0.226276277</span></span>
<span><span class="co">## [14,]  0.018081116  0.159652051  0.007558764</span></span>
<span><span class="co">## [15,] -0.086395896  0.168240767 -0.072151464</span></span>
<span><span class="co">## [16,]  0.275801950 -0.062794962 -0.042297873</span></span>
<span><span class="co">## [17,]  0.076612981 -0.072268445 -0.015357537</span></span>
<span><span class="co">## [18,] -0.301318724  0.013760542  0.089579743</span></span>
<span><span class="co">## [19,]  0.108663366 -0.147207084  0.119050488</span></span>
<span><span class="co">## [20,] -0.072857345 -0.316737312  0.143100018</span></span>
<span><span class="co">## [21,] -0.165796273  0.086263146 -0.016303503</span></span>
<span><span class="co">## [22,] -0.034147355  0.360213246  0.132131155</span></span>
<span><span class="co">## [23,] -0.159119423 -0.150110826  0.068748179</span></span>
<span><span class="co">## [24,] -0.112199641  0.114321240  0.035387919</span></span>
<span><span class="co">## [25,] -0.095806922  0.110278363 -0.258608120</span></span>
<span><span class="co">## [26,] -0.259548250 -0.148445367  0.091090286</span></span>
<span><span class="co">## [27,]  0.128999408  0.040994788 -0.032833724</span></span>
<span><span class="co">## [28,]  0.023204808  0.188278991 -0.010999353</span></span>
<span><span class="co">## [29,] -0.174206293 -0.020689301  0.133977243</span></span>
<span><span class="co">## [30,]  0.194293348  0.014222674  0.010325735</span></span>
<span><span class="co">## [31,]  0.065386973 -0.003787760 -0.202086199</span></span>
<span><span class="co">## [32,] -0.043879727 -0.055229859 -0.062908725</span></span>
<span><span class="co">## [33,]  0.139560043  0.048540859 -0.005551498</span></span>
<span><span class="co">## [34,]  0.135421214 -0.102537010  0.059005445</span></span>
<span><span class="co">## [35,]  0.125618427  0.027202751  0.286836794</span></span>
<span><span class="co">## [36,]  0.105015368 -0.059267066 -0.157854918</span></span>
<span><span class="co">## [37,]  0.086301959 -0.171659691  0.203938075</span></span>
<span><span class="co">## [38,] -0.009250141 -0.064545759 -0.102766868</span></span>
<span><span class="co">## [39,] -0.048405933  0.050149293 -0.267465332</span></span>
<span><span class="co">## [40,] -0.059755121 -0.176554533  0.201304798</span></span>
<span><span class="co">## [41,] -0.107883587 -0.151420171 -0.097658660</span></span>
<span><span class="co">## [42,] -0.030531541 -0.086944042  0.037031443</span></span>
<span><span class="co">## [43,] -0.195746319 -0.024063428  0.219994042</span></span>
<span><span class="co">## [44,]  0.336216114  0.085233704  0.211767844</span></span>
<span><span class="co">## [45,]  0.187725333 -0.220505044  0.223586939</span></span>
<span><span class="co">## [46,] -0.174486176  0.099239743  0.074281232</span></span>
<span><span class="co">## [47,] -0.061700213 -0.335568677  0.204314522</span></span>
<span><span class="co">## [48,] -0.071992629 -0.235570442 -0.095921306</span></span>
<span><span class="co">## [49,]  0.119524364  0.029978028 -0.293655717</span></span>
<span><span class="co">## [50,] -0.013357716  0.160590840  0.179739102</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">##               [,1]         [,2]        [,3]</span></span>
<span><span class="co">##  [1,]  0.153451410  0.103728744  0.02523000</span></span>
<span><span class="co">##  [2,]  0.149809322 -0.020668183  0.05133173</span></span>
<span><span class="co">##  [3,]  0.064577783  0.008837215  0.26026658</span></span>
<span><span class="co">##  [4,] -0.196783701 -0.101984935 -0.10911356</span></span>
<span><span class="co">##  [5,] -0.023400288  0.272092609 -0.20962265</span></span>
<span><span class="co">##  [6,] -0.054304945  0.014460743  0.35450759</span></span>
<span><span class="co">##  [7,]  0.109752214  0.083414275 -0.09349711</span></span>
<span><span class="co">##  [8,] -0.072351548 -0.062540981 -0.15302545</span></span>
<span><span class="co">##  [9,]  0.190073346  0.200927745 -0.26242718</span></span>
<span><span class="co">## [10,] -0.073040400  0.042440313 -0.27195648</span></span>
<span><span class="co">## [11,]  0.204728761  0.119106907 -0.12208097</span></span>
<span><span class="co">## [12,] -0.204458479 -0.273863623  0.13085069</span></span>
<span><span class="co">## [13,] -0.244958040 -0.439205370  0.23427661</span></span>
<span><span class="co">## [14,]  0.630699848 -0.067849247  0.14964563</span></span>
<span><span class="co">## [15,] -0.081235272 -0.045412089 -0.07728988</span></span>
<span><span class="co">## [16,]  0.058249708  0.173491223  0.01289472</span></span>
<span><span class="co">## [17,]  0.123859823 -0.062621794 -0.14896289</span></span>
<span><span class="co">## [18,] -0.094168471  0.378558619 -0.15137640</span></span>
<span><span class="co">## [19,]  0.101235231 -0.141929444  0.18725265</span></span>
<span><span class="co">## [20,]  0.071932143  0.027007631 -0.21463962</span></span>
<span><span class="co">## [21,] -0.041557634 -0.421125156  0.41361434</span></span>
<span><span class="co">## [22,]  0.013111406 -0.048791952 -0.01907238</span></span>
<span><span class="co">## [23,] -0.006851680 -0.120612066  0.04540812</span></span>
<span><span class="co">## [24,]  0.414031115  0.241004135 -0.15646242</span></span>
<span><span class="co">## [25,] -0.143852524  0.171132263 -0.12072122</span></span>
<span><span class="co">## [26,] -0.213259775  0.129259061 -0.27860942</span></span>
<span><span class="co">## [27,]  0.007289243  0.143683713 -0.03852754</span></span>
<span><span class="co">## [28,]  0.059910017 -0.005174385  0.08849014</span></span>
<span><span class="co">## [29,]  0.085205823 -0.156344890  0.06882277</span></span>
<span><span class="co">## [30,] -0.089483580  0.143626201 -0.16512967</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[3]]</span></span>
<span><span class="co">##               [,1]         [,2]         [,3]</span></span>
<span><span class="co">##  [1,] -0.131753885 -0.080967773 -0.034864663</span></span>
<span><span class="co">##  [2,] -0.083795276 -0.072986113 -0.178604123</span></span>
<span><span class="co">##  [3,]  0.249026552  0.237834287  0.195982103</span></span>
<span><span class="co">##  [4,] -0.189815271 -0.065187046 -0.096483943</span></span>
<span><span class="co">##  [5,] -0.030077243  0.008679679  0.076951027</span></span>
<span><span class="co">##  [6,]  0.317532433 -0.103186576 -0.100314400</span></span>
<span><span class="co">##  [7,] -0.016768019  0.093034583  0.008937331</span></span>
<span><span class="co">##  [8,] -0.226851428 -0.024635615 -0.092582288</span></span>
<span><span class="co">##  [9,] -0.110722366 -0.118955941 -0.196101651</span></span>
<span><span class="co">## [10,]  0.080760714  0.117135238 -0.001548426</span></span>
<span><span class="co">## [11,] -0.062782027 -0.148170423 -0.149289740</span></span>
<span><span class="co">## [12,] -0.093353184  0.292256021  0.174036400</span></span>
<span><span class="co">## [13,] -0.057654437  0.037329907  0.105703243</span></span>
<span><span class="co">## [14,]  0.014845963 -0.192240645 -0.222911348</span></span>
<span><span class="co">## [15,]  0.266944787 -0.067438807 -0.056021036</span></span>
<span><span class="co">## [16,] -0.014614048  0.266306189  0.301175298</span></span>
<span><span class="co">## [17,]  0.180091682  0.201327059  0.200162246</span></span>
<span><span class="co">## [18,]  0.105597163 -0.059109091  0.029630978</span></span>
<span><span class="co">## [19,] -0.018829233 -0.214087505 -0.127025203</span></span>
<span><span class="co">## [20,] -0.255619458  0.043410359  0.014793233</span></span>
<span><span class="co">## [21,] -0.086790168  0.010234916 -0.091575967</span></span>
<span><span class="co">## [22,] -0.081415157 -0.295525668 -0.141038895</span></span>
<span><span class="co">## [23,]  0.007923052 -0.149988058 -0.244861172</span></span>
<span><span class="co">## [24,]  0.217092553 -0.064131440 -0.007694796</span></span>
<span><span class="co">## [25,]  0.382372940  0.049417132  0.007971833</span></span>
<span><span class="co">## [26,]  0.257713854  0.337626976  0.257585022</span></span>
<span><span class="co">## [27,] -0.022393242  0.038877149 -0.014553714</span></span>
<span><span class="co">## [28,] -0.292929503  0.050608212  0.084140008</span></span>
<span><span class="co">## [29,] -0.064659838  0.099875159  0.143395707</span></span>
<span><span class="co">## [30,]  0.015104496  0.090289615  0.026232777</span></span>
<span><span class="co">## [31,]  0.141123529 -0.099709923 -0.148848786</span></span>
<span><span class="co">## [32,]  0.160469191  0.302080861  0.292350496</span></span>
<span><span class="co">## [33,]  0.113930990 -0.015914064  0.062307077</span></span>
<span><span class="co">## [34,] -0.232485116  0.005467605 -0.017700074</span></span>
<span><span class="co">## [35,]  0.141199666  0.084918146  0.131867638</span></span>
<span><span class="co">## [36,] -0.074778241 -0.070185705 -0.048948956</span></span>
<span><span class="co">## [37,]  0.029084193  0.069000215 -0.060146505</span></span>
<span><span class="co">## [38,]  0.012285479  0.165923979  0.004682545</span></span>
<span><span class="co">## [39,]  0.071651046  0.292952814  0.362105132</span></span>
<span><span class="co">## [40,]  0.004010559 -0.286545071 -0.377600458</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[4]]</span></span>
<span><span class="co">##              [,1]         [,2]        [,3]</span></span>
<span><span class="co">##  [1,] -0.04673510 -0.009041208 -0.33873229</span></span>
<span><span class="co">##  [2,]  0.15363561 -0.046065161  0.17561013</span></span>
<span><span class="co">##  [3,]  0.06163463 -0.042381249  0.02448334</span></span>
<span><span class="co">##  [4,]  0.24602512  0.254839591  0.01090426</span></span>
<span><span class="co">##  [5,]  0.18613090 -0.114574903 -0.17280272</span></span>
<span><span class="co">##  [6,] -0.06570763 -0.331714214 -0.05887911</span></span>
<span><span class="co">##  [7,]  0.07873217 -0.109860563  0.01433349</span></span>
<span><span class="co">##  [8,] -0.20464112  0.272522496 -0.05816877</span></span>
<span><span class="co">##  [9,]  0.20898381  0.101340713 -0.05319155</span></span>
<span><span class="co">## [10,] -0.10949745 -0.085774273 -0.03003614</span></span>
<span><span class="co">## [11,]  0.56810632  0.154705763  0.06206835</span></span>
<span><span class="co">## [12,] -0.35993606  0.518329043 -0.41880040</span></span>
<span><span class="co">## [13,] -0.11699431 -0.218615985  0.55804034</span></span>
<span><span class="co">## [14,]  0.20454649  0.202825908 -0.25282167</span></span>
<span><span class="co">## [15,]  0.12656829  0.133858971 -0.26449248</span></span>
<span><span class="co">## [16,] -0.15323455 -0.360937782  0.17699679</span></span>
<span><span class="co">## [17,] -0.21914235  0.187299617 -0.15013979</span></span>
<span><span class="co">## [18,]  0.02111825 -0.201478719  0.28045034</span></span>
<span><span class="co">## [19,]  0.01253136  0.304267359 -0.03075699</span></span>
<span><span class="co">## [20,] -0.41463941  0.081520873 -0.23469032</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[5]]</span></span>
<span><span class="co">##           [,1]         [,2]        [,3]</span></span>
<span><span class="co">## [1,] 0.7047503 1.998101e-05 0.705009453</span></span>
<span><span class="co">## [2,] 0.7041715 7.053181e-01 0.007060946</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[1]]</span></span>
<span><span class="co">##               [,1]         [,2]         [,3]</span></span>
<span><span class="co">##  [1,] -0.086673406 -0.099668082 -0.037700862</span></span>
<span><span class="co">##  [2,] -0.033520308  0.035951511  0.007017332</span></span>
<span><span class="co">##  [3,]  0.240272793 -0.034474417 -0.003224211</span></span>
<span><span class="co">##  [4,]  0.011422677 -0.049131310 -0.214291871</span></span>
<span><span class="co">##  [5,]  0.019996113 -0.133395816  0.034880593</span></span>
<span><span class="co">##  [6,]  0.263307705 -0.006421093 -0.253506911</span></span>
<span><span class="co">##  [7,]  0.071350936 -0.109923695  0.242057226</span></span>
<span><span class="co">##  [8,] -0.195474948 -0.233604661 -0.081872112</span></span>
<span><span class="co">##  [9,] -0.106050292 -0.053581920 -0.016710650</span></span>
<span><span class="co">## [10,] -0.067518536  0.128539785 -0.031999940</span></span>
<span><span class="co">## [11,]  0.189522287 -0.080697690 -0.066123633</span></span>
<span><span class="co">## [12,]  0.054851038  0.085597614  0.074382167</span></span>
<span><span class="co">## [13,]  0.061543055 -0.226275742  0.049693558</span></span>
<span><span class="co">## [14,]  0.018074780 -0.007557148  0.159839769</span></span>
<span><span class="co">## [15,] -0.086388627  0.072155371  0.167917002</span></span>
<span><span class="co">## [16,]  0.275810240  0.042297319 -0.062483114</span></span>
<span><span class="co">## [17,]  0.076617180  0.015355339 -0.072239824</span></span>
<span><span class="co">## [18,] -0.301332021 -0.089581032  0.013551751</span></span>
<span><span class="co">## [19,]  0.108648353 -0.119052206 -0.146635608</span></span>
<span><span class="co">## [20,] -0.072871902 -0.143104918 -0.316547619</span></span>
<span><span class="co">## [21,] -0.165796169  0.016306321  0.085947847</span></span>
<span><span class="co">## [22,] -0.034178150 -0.132124590  0.360956491</span></span>
<span><span class="co">## [23,] -0.159126534 -0.068752369 -0.150257465</span></span>
<span><span class="co">## [24,] -0.112208042 -0.035386620  0.114336869</span></span>
<span><span class="co">## [25,] -0.095767648  0.258609305  0.109142912</span></span>
<span><span class="co">## [26,] -0.259557576 -0.091092020 -0.148691767</span></span>
<span><span class="co">## [27,]  0.129002928  0.032836040  0.041142666</span></span>
<span><span class="co">## [28,]  0.023201470  0.011003577  0.188424344</span></span>
<span><span class="co">## [29,] -0.174225483 -0.133978642 -0.020502346</span></span>
<span><span class="co">## [30,]  0.194290654 -0.010324123  0.014647774</span></span>
<span><span class="co">## [31,]  0.065419138  0.202083098 -0.004475709</span></span>
<span><span class="co">## [32,] -0.043868585  0.062906440 -0.055609818</span></span>
<span><span class="co">## [33,]  0.139559086  0.005552166  0.048824086</span></span>
<span><span class="co">## [34,]  0.135414307 -0.059006325 -0.102120357</span></span>
<span><span class="co">## [35,]  0.125571322 -0.286835035  0.028614604</span></span>
<span><span class="co">## [36,]  0.105042101  0.157854374 -0.059742748</span></span>
<span><span class="co">## [37,]  0.086273870 -0.203940739 -0.170809882</span></span>
<span><span class="co">## [38,] -0.009231505  0.102763337 -0.065026945</span></span>
<span><span class="co">## [39,] -0.048364128  0.267467968  0.049023790</span></span>
<span><span class="co">## [40,] -0.059782601 -0.201308262 -0.175997980</span></span>
<span><span class="co">## [41,] -0.107863975  0.097655536 -0.152135003</span></span>
<span><span class="co">## [42,] -0.030535127 -0.037033423 -0.086920548</span></span>
<span><span class="co">## [43,] -0.195779955 -0.219993699 -0.023574969</span></span>
<span><span class="co">## [44,]  0.336178834 -0.211767476  0.086792060</span></span>
<span><span class="co">## [45,]  0.187695807 -0.223589763 -0.219418943</span></span>
<span><span class="co">## [46,] -0.174499747 -0.074280219  0.099279378</span></span>
<span><span class="co">## [47,] -0.061723718 -0.204321255 -0.335128378</span></span>
<span><span class="co">## [48,] -0.071970640  0.095916439 -0.236274747</span></span>
<span><span class="co">## [49,]  0.119570114  0.293654730  0.029051999</span></span>
<span><span class="co">## [50,] -0.013390811 -0.179735402  0.161409591</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">##               [,1]        [,2]        [,3]</span></span>
<span><span class="co">##  [1,]  0.153451898 -0.02523471  0.13624136</span></span>
<span><span class="co">##  [2,]  0.149809741 -0.05133684 -0.12790862</span></span>
<span><span class="co">##  [3,]  0.064578112 -0.26026809  0.01971373</span></span>
<span><span class="co">##  [4,] -0.196784207  0.10912020  0.28536869</span></span>
<span><span class="co">##  [5,] -0.023400020  0.20962431  0.04606691</span></span>
<span><span class="co">##  [6,] -0.054305380 -0.35450559 -0.31308056</span></span>
<span><span class="co">##  [7,]  0.109752445  0.09349398  0.09961450</span></span>
<span><span class="co">##  [8,] -0.072351787  0.15302751 -0.07037773</span></span>
<span><span class="co">##  [9,]  0.190074087  0.26242150  0.22937989</span></span>
<span><span class="co">## [10,] -0.073040636  0.27195880 -0.08422822</span></span>
<span><span class="co">## [11,]  0.204729428  0.12207453  0.07098355</span></span>
<span><span class="co">## [12,] -0.204458937 -0.13084477  0.22793582</span></span>
<span><span class="co">## [13,] -0.244958962 -0.23426965  0.41606738</span></span>
<span><span class="co">## [14,]  0.630701372 -0.14966691  0.01221477</span></span>
<span><span class="co">## [15,] -0.081235507  0.07729257 -0.10419867</span></span>
<span><span class="co">## [16,]  0.058249766 -0.01289615 -0.03705077</span></span>
<span><span class="co">## [17,]  0.123860453  0.14895879  0.16077338</span></span>
<span><span class="co">## [18,] -0.094168887  0.15138062 -0.24295659</span></span>
<span><span class="co">## [19,]  0.101234902 -0.18725642 -0.12970426</span></span>
<span><span class="co">## [20,]  0.071933079  0.21463705 -0.15959605</span></span>
<span><span class="co">## [21,] -0.041557899 -0.41361374 -0.08526431</span></span>
<span><span class="co">## [22,]  0.013111067  0.01907176  0.20285688</span></span>
<span><span class="co">## [23,] -0.006851482 -0.04540803  0.04584690</span></span>
<span><span class="co">## [24,]  0.414032220  0.15644850 -0.31088968</span></span>
<span><span class="co">## [25,] -0.143852800  0.12072625 -0.20396962</span></span>
<span><span class="co">## [26,] -0.213260079  0.27861622 -0.32959558</span></span>
<span><span class="co">## [27,]  0.007289434  0.03852758  0.15224632</span></span>
<span><span class="co">## [28,]  0.059910146 -0.08849190  0.09775597</span></span>
<span><span class="co">## [29,]  0.085206290 -0.06882598  0.04820815</span></span>
<span><span class="co">## [30,] -0.089483578  0.16513295  0.08000261</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[3]]</span></span>
<span><span class="co">##               [,1]         [,2]          [,3]</span></span>
<span><span class="co">##  [1,] -0.131754239  0.034865346  0.0149510641</span></span>
<span><span class="co">##  [2,] -0.083795637  0.178604077 -0.1964019872</span></span>
<span><span class="co">##  [3,]  0.249027338 -0.195983465 -0.2284489644</span></span>
<span><span class="co">##  [4,] -0.189815832  0.096484451  0.0263722330</span></span>
<span><span class="co">##  [5,] -0.030077103 -0.076950592  0.0694548083</span></span>
<span><span class="co">##  [6,]  0.317533109  0.100313168  0.0865680974</span></span>
<span><span class="co">##  [7,] -0.016768106 -0.008937733 -0.1506049164</span></span>
<span><span class="co">##  [8,] -0.226852060  0.092582720 -0.3403962029</span></span>
<span><span class="co">##  [9,] -0.110722845  0.196102170  0.2635256451</span></span>
<span><span class="co">## [10,]  0.080760934  0.001547911 -0.0009111201</span></span>
<span><span class="co">## [11,] -0.062782216  0.149290051  0.0362079223</span></span>
<span><span class="co">## [12,] -0.093353193 -0.174036442 -0.1205185200</span></span>
<span><span class="co">## [13,] -0.057654570 -0.105702905  0.1678798568</span></span>
<span><span class="co">## [14,]  0.014845706  0.222911062 -0.0594083165</span></span>
<span><span class="co">## [15,]  0.266945300  0.056020113  0.1071493726</span></span>
<span><span class="co">## [16,] -0.014613818 -0.301175283 -0.0779948468</span></span>
<span><span class="co">## [17,]  0.180092226 -0.200163030 -0.0588142020</span></span>
<span><span class="co">## [18,]  0.105597532 -0.029631548 -0.2279600661</span></span>
<span><span class="co">## [19,] -0.018829441  0.127025845  0.1508984838</span></span>
<span><span class="co">## [20,] -0.255620032 -0.014792287  0.0897325373</span></span>
<span><span class="co">## [21,] -0.086790443  0.091576042 -0.0543459454</span></span>
<span><span class="co">## [22,] -0.081415490  0.141039387 -0.3298262855</span></span>
<span><span class="co">## [23,]  0.007922844  0.244860883 -0.0894269341</span></span>
<span><span class="co">## [24,]  0.217093124  0.007694338  0.0500961763</span></span>
<span><span class="co">## [25,]  0.382373902 -0.007973492 -0.2356928287</span></span>
<span><span class="co">## [26,]  0.257714780 -0.257586403  0.0702782739</span></span>
<span><span class="co">## [27,] -0.022393310  0.014553707 -0.0961507555</span></span>
<span><span class="co">## [28,] -0.292930141 -0.084138695  0.0249999707</span></span>
<span><span class="co">## [29,] -0.064659791 -0.143395149 -0.0550803950</span></span>
<span><span class="co">## [30,]  0.015104613 -0.026232588  0.1598565257</span></span>
<span><span class="co">## [31,]  0.141123634  0.148848004 -0.0690377558</span></span>
<span><span class="co">## [32,]  0.160469898 -0.292350798  0.3104011861</span></span>
<span><span class="co">## [33,]  0.113931184 -0.062307718 -0.3863375401</span></span>
<span><span class="co">## [34,] -0.232485596  0.017701230  0.1354369602</span></span>
<span><span class="co">## [35,]  0.141200259 -0.131868218 -0.0967739342</span></span>
<span><span class="co">## [36,] -0.074778325  0.048949330 -0.0088192822</span></span>
<span><span class="co">## [37,]  0.029084192  0.060146080  0.0961220182</span></span>
<span><span class="co">## [38,]  0.012285502 -0.004683152 -0.1044045286</span></span>
<span><span class="co">## [39,]  0.071651684 -0.362104781  0.1302457268</span></span>
<span><span class="co">## [40,]  0.004010186  0.377600166  0.0136686735</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[4]]</span></span>
<span><span class="co">##              [,1]         [,2]         [,3]</span></span>
<span><span class="co">##  [1,] -0.04671822  0.266026690 -0.009040455</span></span>
<span><span class="co">##  [2,]  0.15371789 -0.149435722 -0.046076364</span></span>
<span><span class="co">##  [3,]  0.06171265 -0.028132459 -0.042394332</span></span>
<span><span class="co">##  [4,]  0.24552833  0.071652357  0.254840500</span></span>
<span><span class="co">##  [5,]  0.18634714  0.084649699 -0.114538110</span></span>
<span><span class="co">##  [6,] -0.06506845 -0.062261188 -0.331706231</span></span>
<span><span class="co">##  [7,]  0.07893975 -0.047942611 -0.109856243</span></span>
<span><span class="co">##  [8,] -0.20515777  0.133109274  0.272524810</span></span>
<span><span class="co">##  [9,]  0.20878366  0.070863841  0.101347220</span></span>
<span><span class="co">## [10,] -0.10932991 -0.005343977 -0.085766379</span></span>
<span><span class="co">## [11,]  0.56779591 -0.013945154  0.154732173</span></span>
<span><span class="co">## [12,] -0.36092125  0.507540515  0.518307200</span></span>
<span><span class="co">## [13,] -0.11657655 -0.489534139 -0.218667387</span></span>
<span><span class="co">## [14,]  0.20415097  0.260264896  0.202835915</span></span>
<span><span class="co">## [15,]  0.12630754  0.249356393  0.133865504</span></span>
<span><span class="co">## [16,] -0.15253818 -0.250068104 -0.360949524</span></span>
<span><span class="co">## [17,] -0.21949797  0.192441461  0.187269256</span></span>
<span><span class="co">## [18,]  0.02150320 -0.276616784 -0.201504536</span></span>
<span><span class="co">## [19,]  0.01194848  0.120285307  0.304268508</span></span>
<span><span class="co">## [20,] -0.41478448  0.216705226  0.081514511</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[5]]</span></span>
<span><span class="co">##           [,1]        [,2]          [,3]</span></span>
<span><span class="co">## [1,] 0.7047476 -0.70500613 -4.135482e-05</span></span>
<span><span class="co">## [2,] 0.7041945  0.00892746  7.047717e-01</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sideBySidePlot</span><span class="op">(</span><span class="va">Anorm</span>, <span class="va">cmtf_result</span>, <span class="va">acmtf_result</span>, <span class="va">Z</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## New names:</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `postprocessModel(Anorm, cmtf_result[[i]]$Fac, Z)$matchScore` -&gt;</span></span>
<span><span class="co">##   `postprocessModel(Anorm, cmtf_result[[i]]$Fac, Z)$matchScore...1`</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `postprocessModel(Anorm, cmtf_result[[i]]$Fac, Z)$matchScore` -&gt;</span></span>
<span><span class="co">##   `postprocessModel(Anorm, cmtf_result[[i]]$Fac, Z)$matchScore...2`</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `postprocessModel(Anorm, cmtf_result[[i]]$Fac, Z)$matchScore` -&gt;</span></span>
<span><span class="co">##   `postprocessModel(Anorm, cmtf_result[[i]]$Fac, Z)$matchScore...3`</span></span></code></pre>
<pre><code><span><span class="co">## Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if</span></span>
<span><span class="co">## `.name_repair` is omitted as of tibble 2.0.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Using compatibility `.name_repair`.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<pre><code><span><span class="co">## New names:</span></span>
<span><span class="co">## `summarise()` has grouped output by 'type'. You can override using the</span></span>
<span><span class="co">## `.groups` argument.</span></span>
<span><span class="co">## `summarise()` has grouped output by 'type'. You can override using the</span></span>
<span><span class="co">## `.groups` argument.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `postprocessModel(Anorm, acmtf_result[[i]]$Fac, Z)$matchScore` -&gt;</span></span>
<span><span class="co">##   `postprocessModel(Anorm, acmtf_result[[i]]$Fac, Z)$matchScore...1`</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `postprocessModel(Anorm, acmtf_result[[i]]$Fac, Z)$matchScore` -&gt;</span></span>
<span><span class="co">##   `postprocessModel(Anorm, acmtf_result[[i]]$Fac, Z)$matchScore...2`</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `postprocessModel(Anorm, acmtf_result[[i]]$Fac, Z)$matchScore` -&gt;</span></span>
<span><span class="co">##   `postprocessModel(Anorm, acmtf_result[[i]]$Fac, Z)$matchScore...3`</span></span></code></pre>
<p><img src="ACMTF_simulation_files/figure-html/create%20overview%20plot%20case%201-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Geert Roelof van der Ploeg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
